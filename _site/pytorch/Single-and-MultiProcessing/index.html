<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Pytorch data api : Multiprocessing - Woongjoon_AI</title>
<meta name="description" content="Pytorch multiprocess">


  <meta name="author" content="Choi Woongjoon">
  
  <meta property="article:author" content="Choi Woongjoon">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Woongjoon_AI">
<meta property="og:title" content="Pytorch data api : Multiprocessing">
<meta property="og:url" content="http://localhost:4000/pytorch/Single-and-MultiProcessing/">


  <meta property="og:description" content="Pytorch multiprocess">







  <meta property="article:published_time" content="2022-09-16T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/pytorch/Single-and-MultiProcessing/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Choi Woongjoon",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Woongjoon_AI Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Woongjoon_AI
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EUebRgY_s5xFikJdu4cCTZgBSeQd5DRoslVvEaEhYt2WYw?e=kNtQkx">CV</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EY70u-guz5BOnxNWqBdBcrIBoAbFny3p8tUOcPE8x7QZTA?e=h34VMJ">CV_KR</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Choi Woongjoon</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> developer.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Goyang/Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:oongjoon10@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://sites.google.com/view/woognjunchoiai/%ED%99%88" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ANWTNev5jkzYwoC" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/woongjoonchoi" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
    
  
    <!--ì „ì²´ ê¸€ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•œ ì—°ì‚°. sum ë³€ìˆ˜ì— ì „ì²´ ê¸€ ìˆ˜ ì €ìž¥-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--ì „ì²´ ê¸€ ìˆ˜-->
      <li>
            ðŸ“‚ <span style="font-family:'Cafe24Oneprettynight';">ì „ì²´ ê¸€ ìˆ˜</style> <span style="font-family:'Coming Soon';">80</style> <span style="font-family:'Cafe24Oneprettynight';">ê°œ</style> 
      </li>
      <li>
        <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->

        <span class="nav__sub-title">Programming</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Python" class="">Python(9)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            
        <span class="nav__sub-title">Coding Interview</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingTest" class="">CodingTest (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingInterview" class="">CodingInterview (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/Codingtechnique" class="">Codingtechnique (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Computer Science</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DataStructure" class="">DataStructure (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Algorithm" class="">Algorithm (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

      </li>
        <span class="nav__sub-title">DeepLearning</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Pytorch" class="">Pytorch (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Huggingface" class="">Huggingface (4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Optimization" class="">Optimization (5)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/NLP" class="">NLP (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>    
           <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLArchitecture" class="">DLArchitecture (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Software Engineering</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CICD" class="">CI/CD (8)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/OS" class="">Operating System  (1)</a></li>
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Tools" class="">Tools (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Development" class="">Development (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Network" class="">Network (6)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>


        <span class="nav__sub-title">DeepLearningSpecialization</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C3" class="">ML Strategy(2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C2" class="">DLS Assignment(2)</a></li>
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">ML</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/StandfordML" class="">StandfordML(1)</a></li>
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/modeloptimization" class="">ModelOptimization(4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/Handsonmachinelearning" class="">Handsonmachinelearning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/PatternRecognitionML" class="">Pattern Recognition and Machine Learning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
        <span class="nav__sub-title">Data Engineering</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                        <li><a href="/categories/Data-Engineering-basic" class="">Data Engineeringê¸°ë³¸ (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">GCP</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/GCP/Bigquery" class="">Bigquery(3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">Mathmatics</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>

                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Linear_Algebra" class="">Linear Algebra (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Statisticd" class="">Statistics (1)</a></li>
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">DeepLearningAI NLP</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DeepLearningai_nlp" class="">DeepLearning.ai nlp qa (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Data Analytics</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Visualization" class="">Data Visualization (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
  </ul>
</nav>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Pytorch data api : Multiprocessing">
    <meta itemprop="description" content="Pytorch multiprocess">
    <meta itemprop="datePublished" content="2022-09-16T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/pytorch/Single-and-MultiProcessing/" class="u-url" itemprop="url">Pytorch data api : Multiprocessing
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#default-option">Default Option</a></li><li><a href="#single-processing">Single Processing</a></li><li><a href="#multi-processing">Multi Processing</a><ul><li><a href="#iterating-dataloader">Iterating DataLoader</a><ul><li><a href="#map-style">Map-style</a></li><li><a href="#iterative-style">Iterative-style</a><ul><li><a href="#using-get_worker_info">Using get_worker_info()</a></li><li><a href="#using-worker_init_fnworker_id">Using worker_init_fn(worker_id)</a></li></ul></li><li><a href="#warning">Warning</a></li></ul></li><li><a href="#platform-specific">Platform Specific</a></li><li><a href="#randomness-in-multiprocessing-data-loading">Randomness in multiprocessing data loading</a></li><li><a href="#issues">Issues</a></li></ul></li><li><a href="#references">References</a></li></ul>

            </nav>
          </aside>
        
        <p>Pytorchì—ì„œ DataLoadingì„ í•  ë•Œ DataLoaderë¼ëŠ” classë¥¼ ì‚¬ìš©í•˜ëŠ”ë° , ì´ ë•Œ Dataë¥¼ ë‹¨ì¼ Processë‚´ì—ì„œ loading í• ìˆ˜ë„ ìžˆê³ , parallelizeí•´ì„œ loadingì„ í•  ìˆ˜ë„ ìžˆë‹¤.</p>

<h1 id="default-option">Default Option</h1>
<p>DataLoaderëŠ” Single Process data loadingì´ default optionìž…ë‹ˆë‹¤ .</p>

<p>Python ProcessëŠ” GIL(Global Interpretatoin Lock)ì´ Python Codeë¥¼ threadë¡œ parallelizeí•˜ëŠ” ê²ƒì„ ë§‰ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, data loadingì—ì„œ computationì„ 1ê°œì˜ processê°€ blocking í•˜ëŠ”ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ ,PytorchëŠ” â€˜num_workersâ€™ ë¼ëŠ” argumentë¥¼ ì–‘ì˜ ì •ìˆ˜ë¡œ ì„¤ì •í•˜ì—¬ multi-process data loadingìœ¼ë¡œ ì‰½ê²Œ ì „í™˜ ì‹œí‚µë‹ˆë‹¤.</p>

<h1 id="single-processing">Single Processing</h1>

<p>data fetchingì´ ê°™ì€ processë‚´ì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì¦‰, 1ê°œì˜ processê°€ computingì„ blockí•˜ëŠ” ìƒíƒœìž…ë‹ˆë‹¤. 
ì´ ë°©ë²•ì€ resourceê°€ ì œí•œì´ ë˜ê±°ë‚˜ , ì „ì²´ memory ì— dataë¥¼ ì˜¬ë¦´ ìˆ˜ ìžˆì„ë§Œí¼ ìž‘ë‹¤ë©´ , ì„ í˜¸ë˜ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤.<br />
ë˜í•œ, ì´ ë°©ë²•ì˜ ìž¥ì ìœ¼ë¡œëŠ” error tracingì´ ì‰½ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ì— ëŒ€í•´ì„œëŠ”, Multi Processingì—ì„œ ìžì„¸ížˆ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<h1 id="multi-processing">Multi Processing</h1>

<p>Dataloaderì—ì„œëŠ” num_workersë¼ëŠ” argumentë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>

<ol>
  <li>â€˜num_workersâ€™ = 0
    <ul>
      <li>data loadingì´ main processì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>â€˜num_workersâ€™ &gt; 0
    <ul>
      <li>multi-process data loading ì´ í™œì„±í™”ë˜ê³  , ì§€ì •í•œ ìˆ«ìžë§Œí¼ì˜ worker processê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤ . ì´ subprocessë“¤ì´ data loadingì— ì‚¬ìš©ë©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ol>

<p>dataë¥¼ loadingí•  ë•Œ ì—ëŠ” , enumerate(dataloader)ë¥¼ call í•˜ì—¬ , ë§¤ë²ˆ DataLoaderì˜ iteratorë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ , `num_workersâ€™ argumentì— ì§€ì •í•œ ê°œìˆ˜ ë§Œí¼ì˜ worker_processê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  , â€˜datasetâ€™ , â€˜collate_fnâ€™, â€˜worker_init_fnâ€™ì´ ê°  workerì— ì „ë‹¬ì´ ë©ë‹ˆë‹¤. workerê°€  initialize ëœ í›„ ,   dataê°€ fetch ë˜ì–´ì§‘ë‹ˆë‹¤.</p>

<p>ì¦‰ , Internal I/O , transformation(â€˜collate_fnâ€™ í¬í•¨)ì´  dataset accessì™€ í•¨ê»˜ , worker_processì—ì„œ ì‹¤í–‰ë˜ì–´ì§ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>

<h2 id="iterating-dataloader">Iterating DataLoader</h2>

<p>ì‹¤ì œë¡œ , Dataë¥¼ ì—¬ëŸ¬ê°œì˜ workerì—ì„œ fetching í•  ë•Œì—ëŠ” , torch.utils.data.get_worekr_info()ë¼ëŠ” methodë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. <br />
ì´ functionì€ ì•„ëž˜ì™€ ê°™ì€ í•­ëª©ì„ returní•©ë‹ˆë‹¤.</p>
<ul>
  <li>worker_id</li>
  <li>dataset replica</li>
  <li>initial seed</li>
  <li>.etc</li>
</ul>

<p>main_processì—ì„œëŠ” Noneì„ return í•˜ê²Œ ë©ë‹ˆë‹¤. Pytorch ê°œë°œìžë“¤ì€ ì´ functionì„ dataset codeë‚˜ worker_init_fnì—ì„œ ì‚¬ìš©í•˜ì—¬ codeê°€ worker_processì—ì„œ ì‹¤í–‰ì¤‘ì¸ì§€ ì•„ë‹Œì§€ë¥¼ íŒë³„í•˜ì—¬ ê°œë³„ì ì¸ dataset_replicaë¥¼ configureí•©ë‹ˆë‹¤.</p>

<p>íŠ¹ížˆ, data shardingì— ë„ì›€ì´ ëœë‹¤ê³  í•©ë‹ˆë‹¤.</p>

<h3 id="map-style">Map-style</h3>

<p>map-style datasetì—ì„œ ì—¬ëŸ¬ subprocessë“¤ì„ ë§Œë“¤ê²Œ ë˜ë©´ , samplerë¥¼ ì‚¬ìš©í•´ì„œ indiciesë¥¼ ë§Œë“¤ê²Œ ë˜ê³  ì´ë¥¼ ê° workerì— ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤ . samplerì—ì„œì˜ shuffling ì€ main processì—ì„œ ìˆ˜í–‰ì´ ë˜ì–´ì§‘ë‹ˆë‹¤. <br />
ì¦‰, main processëŠ” data loadingì—ì„œ shuffleëœ indiciesë¥¼ workerì— í• ë‹¹í•˜ì—¬ dataë¥¼ loadingí•˜ë„ë¡ í•©ë‹ˆë‹¤. <br />
ì•„ëž˜ì˜ ì½”ë“œ ì˜ˆì‹œë¥¼ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="k">class</span> <span class="nc">MyMapDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">start</span> <span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyMapDataset</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">end</span><span class="o">&gt;</span><span class="n">start</span> <span class="p">,</span> <span class="s">"this example code only works with end&gt; = start"</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span> <span class="p">:</span>
        
        <span class="n">worker_info</span>  <span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_worker_info</span><span class="p">()</span>
        <span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="nb">id</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"worekr_id : </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s"> data : </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>


<span class="n">map_ds</span> <span class="o">=</span> <span class="n">MyMapDataset</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">map_ds</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># worekr_id : 0 data : 3
</span>
<span class="c1"># worekr_id : 1 data : 4
# worekr_id : 0 data : 5
</span>

<span class="c1"># worekr_id : 1 data : 6
# worekr_id : 0 data : 7
</span>

<span class="c1"># worekr_id : 1 data : 8
# worekr_id : 0 data : 9
</span>

<span class="c1"># worekr_id : 1 data : 10
# worekr_id : 0 data : 11
</span>

<span class="c1"># worekr_id : 1 data : 12
# worekr_id : 0 data : 13
</span>

<span class="c1"># worekr_id : 1 data : 14
# worekr_id : 0 data : 15
</span>
<span class="c1"># worekr_id : 1 data : 16
</span>

<span class="c1"># worekr_id : 1 data : 18
</span>

<span class="c1">#  ... 
# worekr_id : 0 data : 93
# worekr_id : 1 data : 96
</span>

<span class="c1"># worekr_id : 0 data : 95
# worekr_id : 1 data : 98
</span>
<span class="c1"># worekr_id : 0 data : 97
# worekr_id : 0 data : 99
</span>
<span class="c1"># [tensor([3]), tensor([4]), tensor([5]), tensor([6]), tensor([7]), tensor([8]), tensor([9]), tensor([10]), tensor([11]), tensor([12]), tensor([13]), tensor([14]), tensor([15]), tensor([16]), tensor([17]), tensor([18]), tensor([19]), tensor([20]), tensor([21]), tensor([22]), tensor([23]), tensor([24]), tensor([25]), tensor([26]), tensor([27]), tensor([28]), tensor([29]), tensor([30]), tensor([31]), tensor([32]), tensor([33]), tensor([34]), tensor([35]), tensor([36]), tensor([37]), tensor([38]), tensor([39]), tensor([40]), tensor([41]), tensor([42]), tensor([43]), tensor([44]), tensor([45]), tensor([46]), tensor([47]), tensor([48]), tensor([49]), tensor([50]), tensor([51]), tensor([52]), tensor([53]), tensor([54]), tensor([55]), tensor([56]), tensor([57]), tensor([58]), tensor([59]), tensor([60]), tensor([61]), tensor([62]), tensor([63]), tensor([64]), tensor([65]), tensor([66]), tensor([67]), tensor([68]), tensor([69]), tensor([70]), tensor([71]), tensor([72]), tensor([73]), tensor([74]), tensor([75]), tensor([76]), tensor([77]), tensor([78]), tensor([79]), tensor([80]), tensor([81]), tensor([82]), tensor([83]), tensor([84]), tensor([85]), tensor([86]), tensor([87]), tensor([88]), tensor([89]), tensor([90]), tensor([91]), tensor([92]), tensor([93]), tensor([94]), tensor([95]), tensor([96]), tensor([97]), tensor([98]), tensor([99])]
</span>
</code></pre></div></div>

<p>ë³´ì‹œëŠ” ë°”ì™€ ê°™ì´ ê° indiciesë“¤ì´ workerì— ì „ë‹¬ë˜ì–´ dataë¥¼ loadingí•¨ì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>

<h3 id="iterative-style">Iterative-style</h3>
<p>Iterable sytleì˜ datasetì„ workerë¥¼ ì´ìš©í•´ì„œ loadingí•  ë•Œì—ëŠ” data ì¤‘ë³µì„ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. <br />
Iterable styleì˜ datasetì„ loadingí•  ë•Œ subprocessë“¤ì„ ë§Œë“œëŠ” ê²½ìš° , ê° workerë“¤ì´ dataset objectì˜ replicaë¥¼ ì–»ê²Œ ë©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒì—, ê° workerë“¤ì´ dataset objectë¥¼ iterating í•¨ìœ¼ë¡œ ì¨ , dataì˜ ì¤‘ë³µì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤. ì•„ëž˜ì˜ ì˜ˆì‹œì½”ë“œì—ì„œ í™•ì¸í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="k">class</span> <span class="nc">MyIterableDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">IterableDataset</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyIterableDataset</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">end</span><span class="o">&gt;</span><span class="n">start</span> <span class="p">,</span> <span class="s">"this example code only works with end &gt;=start"</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">worker_info</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_worker_info</span><span class="p">()</span>
        <span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="nb">id</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="n">worker_info</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="p">))</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">MyIterableDataset</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">3</span> <span class="p">,</span><span class="n">end</span> <span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># range(3, 100)
# WorkerInfo(id=0, num_workers=2, seed=4911920692807402111, dataset=&lt;__main__.MyIterableDataset object at 0x7f5d2ef69910&gt;)range(3, 100)
</span>
<span class="c1"># WorkerInfo(id=1, num_workers=2, seed=4911920692807402112, dataset=&lt;__main__.MyIterableDataset object at 0x7f5d2ef69910&gt;)
# [tensor([3]), tensor([3]), tensor([4]), tensor([4]), tensor([5]), tensor([5]), tensor([6]), tensor([6]), tensor([7]), tensor([7]), tensor([8]), tensor([8]), tensor([9]), tensor([9]), tensor([10]), tensor([10]), tensor([11]), tensor([11]), tensor([12]), tensor([12]), tensor([13]), tensor([13]), tensor([14]), tensor([14]), tensor([15]), tensor([15]), tensor([16]), tensor([16]), tensor([17]), tensor([17]), tensor([18]), tensor([18]), tensor([19]), tensor([19]), tensor([20]), tensor([20]), tensor([21]), tensor([21]), tensor([22]), tensor([22]), tensor([23]), tensor([23]), tensor([24]), tensor([24]), tensor([25]), tensor([25]), tensor([26]), tensor([26]), tensor([27]), tensor([27]), tensor([28]), tensor([28]), tensor([29]), tensor([29]), tensor([30]), tensor([30]), tensor([31]), tensor([31]), tensor([32]), tensor([32]), tensor([33]), tensor([33]), tensor([34]), tensor([34]), tensor([35]), tensor([35]), tensor([36]), tensor([36]), tensor([37]), tensor([37]), tensor([38]), tensor([38]), tensor([39]), tensor([39]), tensor([40]), tensor([40]), tensor([41]), tensor([41]), tensor([42]), tensor([42]), tensor([43]), tensor([43]), tensor([44]), tensor([44]), tensor([45]), tensor([45]), tensor([46]), tensor([46]), tensor([47]), tensor([47]), tensor([48]), tensor([48]), tensor([49]), tensor([49]), tensor([50]), tensor([50]), tensor([51]), tensor([51]), tensor([52]), tensor([52]), tensor([53]), tensor([53]), tensor([54]), tensor([54]), tensor([55]), tensor([55]), tensor([56]), tensor([56]), tensor([57]), tensor([57]), tensor([58]), tensor([58]), tensor([59]), tensor([59]), tensor([60]), tensor([60]), tensor([61]), tensor([61]), tensor([62]), tensor([62]), tensor([63]), tensor([63]), tensor([64]), tensor([64]), tensor([65]), tensor([65]), tensor([66]), tensor([66]), tensor([67]), tensor([67]), tensor([68]), tensor([68]), tensor([69]), tensor([69]), tensor([70]), tensor([70]), tensor([71]), tensor([71]), tensor([72]), tensor([72]), tensor([73]), tensor([73]), tensor([74]), tensor([74]), tensor([75]), tensor([75]), tensor([76]), tensor([76]), tensor([77]), tensor([77]), tensor([78]), tensor([78]), tensor([79]), tensor([79]), tensor([80]), tensor([80]), tensor([81]), tensor([81]), tensor([82]), tensor([82]), tensor([83]), tensor([83]), tensor([84]), tensor([84]), tensor([85]), tensor([85]), tensor([86]), tensor([86]), tensor([87]), tensor([87]), tensor([88]), tensor([88]), tensor([89]), tensor([89]), tensor([90]), tensor([90]), tensor([91]), tensor([91]), tensor([92]), tensor([92]), tensor([93]), tensor([93]), tensor([94]), tensor([94]), tensor([95]), tensor([95]), tensor([96]), tensor([96]), tensor([97]), tensor([97]), tensor([98]), tensor([98]), tensor([99]), tensor([99])]
</span>
</code></pre></div></div>

<p>datasetì˜ replicaê°€ ê° workerì— ì „ë‹¬ë˜ì–´ ì¤‘ë³µë˜ê²Œ fetchingí•¨ì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. <br />
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì´ ìžˆìŠµë‹ˆë‹¤.</p>

<h4 id="using-get_worker_info">Using get_worker_info()</h4>

<p>ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ , get_worker_info() ëŠ” main_processì˜ ê²½ìš° Noneì„ returní•˜ê³  , subprocessì˜ ê²½ìš°ì—ëŠ” id,replica ,seed ë“±ë“±ì„ returní•©ë‹ˆë‹¤. worker_idë¥¼ ì´ìš©í•´ì„œ ê° workerë§ˆë‹¤ fetchingì„ configurationì„ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MyIterableDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">IterableDataset</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyIterableDataset</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="n">start</span> <span class="p">,</span> <span class="s">"this example code only works with end &gt;= start"</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
    
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">worker_info</span><span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_worker_info</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">worker_info</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">:</span>
            <span class="n">iter_start</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">start</span>
            <span class="n">iter_end</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">end</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">per_worker</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="o">-</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">worker_info</span><span class="p">.</span><span class="n">num_workers</span><span class="p">))</span>
            <span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="nb">id</span>
            <span class="n">iter_start</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">worker_id</span> <span class="o">*</span> <span class="n">per_worker</span>
            <span class="n">iter_end</span> <span class="o">=</span>  <span class="nb">min</span><span class="p">(</span><span class="n">iter_start</span> <span class="o">+</span> <span class="n">per_worker</span> <span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'worker_id : </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s"> </span><span class="se">\n</span><span class="s"> iter_start : </span><span class="si">{</span><span class="n">iter_start</span><span class="si">}</span><span class="s">  iter_end : </span><span class="si">{</span><span class="n">iter_end</span><span class="si">}</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">iter_start</span><span class="p">,</span> <span class="n">iter_end</span><span class="p">))</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">MyIterableDataset</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> 


<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">3</span><span class="p">)))</span>


<span class="c1"># worker_id : 0 
#  iter_start : 3  iter_end : 35
# worker_id : 1 
#  iter_start : 35  iter_end : 67
</span>

<span class="c1"># worker_id : 2 
#  iter_start : 67  iter_end : 99
</span>
<span class="c1"># [tensor([3]), tensor([35]), tensor([67]), tensor([4]), tensor([36]), tensor([68]), tensor([5]), tensor([37]), tensor([69]), tensor([6]), tensor([38]), tensor([70]), tensor([7]), tensor([39]), tensor([71]), tensor([8]), tensor([40]), tensor([72]), tensor([9]), tensor([41]), tensor([73]), tensor([10]), tensor([42]), tensor([74]), tensor([11]), tensor([43]), tensor([75]), tensor([12]), tensor([44]), tensor([76]), tensor([13]), tensor([45]), tensor([77]), tensor([14]), tensor([46]), tensor([78]), tensor([15]), tensor([47]), tensor([79]), tensor([16]), tensor([48]), tensor([80]), tensor([17]), tensor([49]), tensor([81]), tensor([18]), tensor([50]), tensor([82]), tensor([19]), tensor([51]), tensor([83]), tensor([20]), tensor([52]), tensor([84]), tensor([21]), tensor([53]), tensor([85]), tensor([22]), tensor([54]), tensor([86]), tensor([23]), tensor([55]), tensor([87]), tensor([24]), tensor([56]), tensor([88]), tensor([25]), tensor([57]), tensor([89]), tensor([26]), tensor([58]), tensor([90]), tensor([27]), tensor([59]), tensor([91]), tensor([28]), tensor([60]), tensor([92]), tensor([29]), tensor([61]), tensor([93]), tensor([30]), tensor([62]), tensor([94]), tensor([31]), tensor([63]), tensor([95]), tensor([32]), tensor([64]), tensor([96]), tensor([33]), tensor([65]), tensor([97]), tensor([34]), tensor([66]), tensor([98])]
</span>

</code></pre></div></div>

<p>ìœ„ì˜ codeì—ì„œ iter methodëŠ” subprocessê°€ ì„¤ì •ë˜ë©´ , num_workersë§Œí¼ dataë¥¼ ë‚˜ëˆ„ì–´ì„œ worker_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ fetchingí•˜ë„ë¡ configuration í•©ë‹ˆë‹¤.</p>

<h4 id="using-worker_init_fnworker_id">Using worker_init_fn(worker_id)</h4>

<p>pytorch dataloaderì˜ argumentì—ëŠ” worker_init_fnì„ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. worker_init_fnì€ worker_idë¥¼ argumentë¡œ ë°›ì•„ì„œ, ê° datasetì˜ replicaë¥¼ ê°œë³„ì ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MyIterableDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">IterableDataset</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyIterableDataset</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">end</span><span class="o">&gt;</span><span class="n">start</span> <span class="p">,</span> <span class="s">"this example code only works with end &gt;=start"</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">worker_info</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_worker_info</span><span class="p">()</span>
        <span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="nb">id</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'worker_id : </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s"> </span><span class="se">\n</span><span class="s"> iter_start : </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="si">}</span><span class="s">  iter_end : </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="si">}</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">end</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">worker_init_fn</span><span class="p">(</span><span class="n">worker_id</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">worker_info</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">get_worker_info</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="n">dataset</span>
    <span class="n">overall_start</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">start</span>
    <span class="n">overall_end</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">end</span>

    <span class="n">per_worker</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">overall_end</span><span class="o">-</span><span class="n">overall_start</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span>
                     <span class="nb">float</span><span class="p">(</span><span class="n">worker_info</span><span class="p">.</span><span class="n">num_workers</span><span class="p">))</span>
    <span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_info</span><span class="p">.</span><span class="nb">id</span>
    <span class="n">dataset</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">overall_start</span> <span class="o">+</span> <span class="n">worker_id</span> <span class="o">*</span> <span class="n">per_worker</span>
    <span class="n">dataset</span><span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">per_worker</span> <span class="p">,</span> <span class="n">overall_end</span><span class="p">)</span>
    <span class="c1"># print(f'worker_id : {worker_id} , worker_start : {dataset.start}  ,  worekr_end : {dataset.end}')
</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">MyIterableDataset</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> 


<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">)))</span>


<span class="c1"># /usr/local/lib/python3.7/dist-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
#   cpuset_checked))
# worker_id : 0 
#  iter_start : 3  iter_end : 12
</span>
<span class="c1"># worker_id : 1 
#  iter_start : 12  iter_end : 21
# worker_id : 2 
#  iter_start : 21  iter_end : 30
</span>
<span class="c1"># worker_id : 3 
#  iter_start : 30  iter_end : 39
</span>

<span class="c1"># worker_id : 4 
#  iter_start : 39  iter_end : 48
</span>
<span class="c1"># worker_id : 5 
#  iter_start : 48  iter_end : 57
</span>
<span class="c1"># worker_id : 6 
#  iter_start : 57  iter_end : 66
</span>
<span class="c1"># worker_id : 7 
#  iter_start : 66  iter_end : 75
</span>
<span class="c1"># worker_id : 8 
#  iter_start : 75  iter_end : 84
</span>
<span class="c1"># worker_id : 9 
#  iter_start : 84  iter_end : 93
</span>
<span class="c1"># [tensor([3]), tensor([12]), tensor([21]), tensor([30]), tensor([39]), tensor([48]), tensor([57]), tensor([66]), tensor([75]), tensor([84]), tensor([4]), tensor([13]), tensor([22]), tensor([31]), tensor([40]), tensor([49]), tensor([58]), tensor([67]), tensor([76]), tensor([85]), tensor([5]), tensor([14]), tensor([23]), tensor([32]), tensor([41]), tensor([50]), tensor([59]), tensor([68]), tensor([77]), tensor([86]), tensor([6]), tensor([15]), tensor([24]), tensor([33]), tensor([42]), tensor([51]), tensor([60]), tensor([69]), tensor([78]), tensor([87]), tensor([7]), tensor([16]), tensor([25]), tensor([34]), tensor([43]), tensor([52]), tensor([61]), tensor([70]), tensor([79]), tensor([88]), tensor([8]), tensor([17]), tensor([26]), tensor([35]), tensor([44]), tensor([53]), tensor([62]), tensor([71]), tensor([80]), tensor([89]), tensor([9]), tensor([18]), tensor([27]), tensor([36]), tensor([45]), tensor([54]), tensor([63]), tensor([72]), tensor([81]), tensor([90]), tensor([10]), tensor([19]), tensor([28]), tensor([37]), tensor([46]), tensor([55]), tensor([64]), tensor([73]), tensor([82]), tensor([91]), tensor([11]), tensor([20]), tensor([29]), tensor([38]), tensor([47]), tensor([56]), tensor([65]), tensor([74]), tensor([83]), tensor([92])]
</span></code></pre></div></div>

<h3 id="warning">Warning</h3>

<p>Pytorch Docsì—ì„œëŠ” CUDA Tensorë¥¼ multi-processing loading ì—ì„œ returní•˜ëŠ” ê²ƒì„ ì¶”ì²œí•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤.  CUDA Tensorë¥¼ ê³µìœ í•˜ê±°ë‚˜ CUDAë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ ì— , automatic memory pinning(pin_memory = True)ì„ ì´ìš©í•´ì„œ  ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤ê³  í•©ë‹ˆë‹¤. ì´ëŠ” CUDAê°€ ì‚¬ìš©ê°€ëŠ¥í•œ GPOë¡œ ë¹ ë¥¸ data ì „ì†¡ì„ í•˜ê²Œ í•œë‹¤ê³  í•©ë‹ˆë‹¤.</p>

<h2 id="platform-specific">Platform Specific</h2>

<p>Python Multiprocessingì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´, OSì— ë”°ë¼ì„œ , worker launch behaviorê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.</p>

<ol>
  <li>UNIX
    <ul>
      <li>fork()ê°€  multiprocessingì„ ì‹œìž‘í•˜ëŠ” default methodìž…ë‹ˆë‹¤. fork()ë¥¼ ì‚¬ìš©í•˜ë©´ , child workerë“¤ì€ ë³µì œëœ address spaceë¥¼ í†µí•´ datasetê³¼ Python functionsì— ì§ì ‘ access í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Windows, MAC
    <ul>
      <li>spawn()ì´ multiprocessingì„ ì‹œìž‘í•˜ëŠ” default methodìž…ë‹ˆë‹¤. spawn()ì„ ì‚¬ìš©í•´ì„œ , ë‹¤ë¥¸ interpereterë“¤ì´ ì‹¤í–‰ë˜ë©´ì„œ , main scriptë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒì— , pickle serializationì„ í†µí•´ dataset, collate_fn , ê·¸ë¦¬ê³  ë‹¤ë¥¸ argumentë¥¼ serialization í•˜ê³  , internal worker functionì„ ì‹¤í–‰í•©ë‹ˆë‹¤. serializationì„ ì‚¬ìš©í•œë‹¤ëŠ”ê±´ multiprocess data loadë¥¼ ì‚¬ìš©í•˜ëŠ”ë™ì•ˆì— Windowsì™€ í˜¸í™˜ì´ ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” 2ë‹¨ê³„ë¥¼ ì‹¤í–‰í•´ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
        <ol>
          <li>main script codeë¥¼ <code class="language-plaintext highlighter-rouge">if __name__  =='__main__'</code> blockìœ¼ë¡œ ë‘˜ëŸ¬ìŒ‰ë‹ˆë‹¤.
            <ul>
              <li>why? ê° worker processê°€ ì‹¤í–‰ë  ë•Œ , ë‹¤ì‹œëŠ” main script codeê°€ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ì„œìž…ë‹ˆë‹¤. main script codeì— Dataset,Datalodaer instance ìƒì„± ì½”ë“œë¥¼ í¬í•¨ì‹œì¼œ , workerì—ì„œ ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤.</li>
            </ul>
          </li>
          <li>custom collate_fn ,worker_init_fn , ê·¸ë¦¬ê³  dataset codeê°€ top level definitionsì—ì„œ ,ì¦‰ <code class="language-plaintext highlighter-rouge">__main__</code> ì„ checkí•˜ëŠ” code ë°”ê¹¥ì—ì„œ  defineë˜ë„ë¡ í•©ë‹ˆë‹¤.
            <ul>
              <li>why? fucntionsë“¤ì´ bytecodeê°€ ì•„ë‹Œ referenceë¡œì¨ pickled ë˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.</li>
            </ul>
          </li>
        </ol>
      </li>
    </ul>
  </li>
</ol>

<h2 id="randomness-in-multiprocessing-data-loading">Randomness in multiprocessing data loading</h2>

<p>ê° workerëŠ” seedë¥¼  (base_seed + worker_id)ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. base_seedëŠ” main_processì— ì˜í•´ì„œ ìƒì„±ì´ ë˜ëŠ”ë° , ì´ ë•Œ RNG(Random Number Generator) ë‚˜ ì§€ì •í•œ generatorë¥¼ ì´ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ seedê°€ ì¤‘ë³µì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ,  worker ê°€ initialized ë  ë•Œ , ê° workerê°€ ë™ì¼í•œ random numberë¥¼ returní•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. <br />
worker_init_fnì—ì„œ torch.utils.data.get_worker_info().seed ë‚˜ torch.initial.seedë¥¼ ì‚¬ìš©í•˜ë©´ ê° workerì— ëŒ€í•œ Pytorch seed setì— accessí•˜ê³  , ì´ë¥¼ ì‚¬ìš©í•˜ì—¬  , data ë¥¼ loadingí•˜ê¸° ì „ì— ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ seedë¥¼ ì „ë‹¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>

<h2 id="issues">Issues</h2>
<ul>
  <li>Problem
    <ul>
      <li>iterationì„ ëª‡ ë²ˆ ë°˜ë³µí•˜ê³  ë‚˜ë©´ , loader worker processê°€ parent processì— ìžˆëŠ” ëª¨ë“  Python Objects(worker processì—ì„œ accessê°€ëŠ¥)ì— ëŒ€í•´ ê°™ì€ ì–‘ì˜ CPU Memoryë¥¼ ì ìœ í•˜ê³  ìžˆìŠµë‹ˆë‹¤.ë§Œì•½ì— , Datasetì´ ì—„ì²­ë‚˜ê²Œ í° data(ex.ë§¤ìš° í° filename lsit)ë¥¼ í¬í•¨í•˜ê±°ë‚˜ ìˆ˜ë§Žì€ workerë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë¬¸ì œê°€ ë°œìƒí•  ê²ƒìž…ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Why?
    <ul>
      <li>ìž„ì˜ì˜ Python Objectsë¥¼  shared memmoryì— ì €ìž¥í•˜ëŠ” ê²ƒì€ copy-on-write problemì„ ë°œìƒì‹œí‚µë‹ˆë‹¤. ì´ objectë“¤ì„ readí•  ë•Œë§ˆë‹¤ , reference countë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤. reference countì˜ ë³€í™”ë¡œ ì¸í•´ forkëœ python processì˜ copy-on-acess problemì´ ë°œìƒí•˜ê²Œ ë˜ëŠ”ê²ƒìž…ë‹ˆë‹¤. (Memory-leak ë¬¸ì œê°€ ì•„ë‹™ë‹ˆë‹¤.)</li>
    </ul>
  </li>
  <li>Sol
    <ul>
      <li>ê¸°ë³¸ì ì¸ Python Objects(list,dict) ëŒ€ì‹ ì— pandas,numpy,pyarrow ê°™ì€ objectsë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë“¤ì€ reference countê°€ 1ìž…ë‹ˆë‹¤.</li>
      <li>Stringì„ ì €ìž¥í•  ë•Œì—ëŠ” , ASCII codeë¡œ numpy arrayë¥¼ ì‚¬ìš©í•˜ì—¬ ì €ìž¥í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì•„ë‹ˆë©´, ByteCodeë‚˜ Custom Datatypeì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
        <h1 id="references">References</h1>
      </li>
    </ul>
  </li>
</ul>

<p><a href="&quot;https://pytorch.org/docs/stable/data.html#single-and-multi-process-data-loading&quot;">Pytorch-data-docs</a></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#deep-learning" class="page__taxonomy-item p-category" rel="tag">deep learning</a><span class="sep">, </span>
    
      <a href="/tags/#machine-learning" class="page__taxonomy-item p-category" rel="tag">Machine Learning</a><span class="sep">, </span>
    
      <a href="/tags/#pytorch" class="page__taxonomy-item p-category" rel="tag">Pytorch</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#pytorch" class="page__taxonomy-item p-category" rel="tag">Pytorch</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-09-16T00:00:00+09:00">September 16, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Pytorch+data+api+%3A+Multiprocessing%20http%3A%2F%2Flocalhost%3A4000%2Fpytorch%2FSingle-and-MultiProcessing%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fpytorch%2FSingle-and-MultiProcessing%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fpytorch%2FSingle-and-MultiProcessing%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      


  
  	
  	
  	
  	
  	


  <nav class="pagination_prev_next">
    
      <a href="/pytorch/Pytorch-data-api-dataset-and-sampler/" class="pagination_prev_next--pager"><span class="prev_next">ì´ì „ ê¸€  &nbsp</span>Pytorch data api : sampler and dataset style</a>
    
    
      <a href="#" class="pagination_prev_next--pager disabled">ê°€ìž¥ ìµœê·¼ ê¸€ìž…ë‹ˆë‹¤</a>
    
  </nav>


<!-- 
  <nav class="pagination">
    
      <a href="/python/Numeric/" class="pagination--pager" title="Numerics
">Previous</a>
    
    
      <a href="/network/The-Physical-Layer/" class="pagination--pager" title="The Phyiscal Layer
">Next</a>
    
  </nav>
 -->
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/network/The-Physical-Layer/" rel="permalink">The Phyiscal Layer
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">TCP 5 layer model-phyiscal
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/Numeric/" rel="permalink">Numerics
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Python Numerics
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/standfordml/polynominal-regerssion/" rel="permalink">Polynomial Regression
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Standford ML
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/Built-in-Objects/" rel="permalink">What is Objects and Why use Built-in objects
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Python Objects
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Choi Woongjoon. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
<script src="/assets/js/main.min.js"></script>







    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'woongjoonchoi/Comments');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'photon-dark');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>
  



<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
extensions: ["tex2jax.js"],
jax: ["input/TeX", "output/HTML-CSS"],
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ],
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
processEscapes: true
},
"HTML-CSS": { availableFonts: ["TeX"] }
});
</script>

  </body>
</html>
