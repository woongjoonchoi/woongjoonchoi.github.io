<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>What is Attention?Why softmax in hidden layer output? - Woongjoon_AI</title>
<meta name="description" content="Attention and Explicit Memory">


  <meta name="author" content="Choi Woongjoon">
  
  <meta property="article:author" content="Choi Woongjoon">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Woongjoon_AI">
<meta property="og:title" content="What is Attention?Why softmax in hidden layer output?">
<meta property="og:url" content="http://localhost:4000/dlarchitecture/Why-Attention-use-sofmtax/">


  <meta property="og:description" content="Attention and Explicit Memory">







  <meta property="article:published_time" content="2022-01-11T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/dlarchitecture/Why-Attention-use-sofmtax/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Choi Woongjoon",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Woongjoon_AI Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Woongjoon_AI
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EUebRgY_s5xFikJdu4cCTZgBSeQd5DRoslVvEaEhYt2WYw?e=kNtQkx">CV</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EY70u-guz5BOnxNWqBdBcrIBoAbFny3p8tUOcPE8x7QZTA?e=h34VMJ">CV_KR</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Choi Woongjoon</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> developer.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Goyang/Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:oongjoon10@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://sites.google.com/view/woognjunchoiai/%ED%99%88" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ANWTNev5jkzYwoC" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/woongjoonchoi" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
    
  
    <!--ì „ì²´ ê¸€ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•œ ì—°ì‚°. sum ë³€ìˆ˜ì— ì „ì²´ ê¸€ ìˆ˜ ì €ìž¥-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--ì „ì²´ ê¸€ ìˆ˜-->
      <li>
            ðŸ“‚ <span style="font-family:'Cafe24Oneprettynight';">ì „ì²´ ê¸€ ìˆ˜</style> <span style="font-family:'Coming Soon';">78</style> <span style="font-family:'Cafe24Oneprettynight';">ê°œ</style> 
      </li>
      <li>
        <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->

        <span class="nav__sub-title">Programming</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Python" class="">Python(8)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            
        <span class="nav__sub-title">Coding Interview</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingTest" class="">CodingTest (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingInterview" class="">CodingInterview (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/Codingtechnique" class="">Codingtechnique (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Computer Science</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DataStructure" class="">DataStructure (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Algorithm" class="">Algorithm (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

      </li>
        <span class="nav__sub-title">DeepLearning</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Pytorch" class="">Pytorch (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Huggingface" class="">Huggingface (4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Optimization" class="">Optimization (5)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/NLP" class="">NLP (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>    
           <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLArchitecture" class="">DLArchitecture (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Software Engineering</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CICD" class="">CI/CD (8)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/OS" class="">Operating System  (1)</a></li>
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Tools" class="">Tools (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Development" class="">Development (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Network" class="">Network (5)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>


        <span class="nav__sub-title">DeepLearningSpecialization</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C3" class="">ML Strategy(2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C2" class="">DLS Assignment(2)</a></li>
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">ML</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/StandfordML" class="">StandfordML(1)</a></li>
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/modeloptimization" class="">ModelOptimization(4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/Handsonmachinelearning" class="">Handsonmachinelearning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/PatternRecognitionML" class="">Pattern Recognition and Machine Learning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
        <span class="nav__sub-title">Data Engineering</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                        <li><a href="/categories/Data-Engineering-basic" class="">Data Engineeringê¸°ë³¸ (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">GCP</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/GCP/Bigquery" class="">Bigquery(3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">Mathmatics</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>

                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Linear_Algebra" class="">Linear Algebra (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Statisticd" class="">Statistics (1)</a></li>
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">DeepLearningAI NLP</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DeepLearningai_nlp" class="">DeepLearning.ai nlp qa (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Data Analytics</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” íŽ˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” íŽ˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Visualization" class="">Data Visualization (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
  </ul>
</nav>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="What is Attention?Why softmax in hidden layer output?">
    <meta itemprop="description" content="Attention and Explicit Memory">
    <meta itemprop="datePublished" content="2022-01-11T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/dlarchitecture/Why-Attention-use-sofmtax/" class="u-url" itemprop="url">What is Attention?Why softmax in hidden layer output?
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          12 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#what-is-attention-">What is Attention ?</a><ul><li><a href="#self-attention">Self-Attention</a></li><li><a href="#multihead-attention">Multihead-attention</a></li></ul></li><li><a href="#why-attention-weighted-sum---detailed">Why Attention Weighted Sum? -&gt; Detailed</a><ul><li><a href="#working-memory">Working Memory?</a></li><li><a href="#memory-cell">Memory Cell</a></li><li><a href="#why-memory-cell-use-vector">Why Memory Cell use vector?</a><ul><li><a href="#soft-alignment">soft-alignment</a></li><li><a href="#computation-cost-reduced">computation cost reduced</a></li><li><a href="#content-based">content-based</a></li></ul></li></ul></li><li><a href="#attention-in-optimization-view">Attention in optimization view</a></li></ul>

            </nav>
          </aside>
        
        <p>2017ë…„ Attention is all you need ë…¼ë¬¸ì´ ë‚˜ì˜¨í›„ 2019ë…„ Bertê°€ ë‚˜ì˜¤ë©´ì„œ Deep Learningì—ì„œ Natural Language domainì´ ê¸‰ë¶€ìƒí–ˆë‹¤ê³  ë§í•´ë„ ê³¼ì–¸ì´ ì•„ë‹™ë‹ˆë‹¤.  Transformerë¼ëŠ” architectureê°€ ë“±ìž¥í•˜ë©´ì„œ, NLPë¶„ì•¼ì—ì„œë„ VISION ì²˜ëŸ¼ Fine-tuningì´ ê°€ëŠ¥í•´ì¡Œê³  , ë‹¤ì–‘í•œ downstream taskë¥¼ ì§„í–‰í•  ìˆ˜ ìžˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. Transformerë¼ëŠ” architectureëŠ” ì—¬ëŸ¬ê°œì˜ multihead attentionìœ¼ë¡œ êµ¬ì„±ì´ ë˜ì–´ìžˆê³  , multihead attentionì€ attention ì´ë¼ëŠ” moduleë¡œ êµ¬ì„±ì´ ë˜ì–´ìžˆìŠµë‹ˆë‹¤. Attention moduleì€ ë‹¤ë¥¸ deeplearning moduleê³¼ ì•„ì£¼ í° ì°¨ì´ì ì´ í•˜ë‚˜ ìžˆìŠµë‹ˆë‹¤. ë°”ë¡œ hidden layerìž„ì—ë„ ë¶ˆêµ¬í•˜ê³  activation functionìœ¼ë¡œ softmax functionì´ ì“°ì´ëŠ” ê²ƒìž…ë‹ˆë‹¤. softmax functionì€ inputë“¤ì„ probability spaceë¡œ ë³€í™˜ì‹œí‚µë‹ˆë‹¤.  í†µê³„ê¸°ë°˜ëª¨ë¸ì€ probabilityì„ ê³„ì‚°í•´ì•¼ í•˜ê¸°ì— output layerì—ì„œ probabilityë¥¼ êµ¬í•˜ëŠ”ë° ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì—  ëŒ€í•´, ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹°ì— ì§ˆë¬¸í–ˆì§€ë§Œ ì´ì— ëŒ€í•´ ìž˜ ì•„ëŠ” ì‚¬ëžŒì€ ì—†ì—ˆìŠµë‹ˆë‹¤ . ì €ë„ í¬ê¸°í•˜ë˜ ì™€ì¤‘ì— ìš°ì—°ížˆ <a href="https://www.deeplearningbook.org/">Deep Learning</a>(by Ian GoodFellow) bookì— ì´ì— ëŒ€í•´ 5~6pg ì •ë„ í• ë‹¹í•´ì„œ ê¸°ìˆ í•´ë†“ì€ê±¸ í™•ì¸í•  ìˆ˜ ìžˆì—ˆìŠµë‹ˆë‹¤. (ëª¨ë¥´ë©´ ì±…ì„ ì°¾ì•„ ë³´ì„¸ìš”!)  .ê·¸ë¦¬ê³  ,<a href="https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646">Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems: </a>(by <a href="https://tensorflow.blog/tag/aurelien-geron/">Aurelien Geron</a>)   ì—ì„œ ì°¾ì•„ë³´ë©´ì„œ Attention ê°œë…ì— ëŒ€í•œ ë” detailí•œ ì´í•´ë¥¼ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ì´ì— ëŒ€í•´ì„œ ë‹¤ë£¨ì–´ ë³¼ê¹Œ í•©ë‹ˆë‹¤.(ìµœëŒ€í•œ ìˆ˜ì‹ì„ ì œì™¸í•˜ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.)(ë³¸ ê¸€ì€ Transformer Architectureë³´ë‹¤ Attention ëª¨ë“ˆì— ì§‘ì¤‘ì„ í•˜ê¸°ì— transformer architecutreì— ëŒ€í•œ ì„¤ëª…ì€ ì˜ë„ì ìœ¼ë¡œ ëºìŠµë‹ˆë‹¤.)</p>

<p>2022-02-21 alignement modifed</p>

<h2 id="what-is-attention-">What is Attention ?</h2>

<p><img src="https://user-images.githubusercontent.com/50165842/148772559-4c347b53-56e5-45d1-8cbe-5d1ebf479273.png" alt="image" /></p>

<p>Attention Mechanismì„ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” Attention ì´ ë‚˜ì˜¤ê¸° ì´ì „ì— Encoder-Decoder Model(Seq2Seq Model)ì´ ì–´ë–»ê²Œ outputì„ ê³„ì‚°í–ˆì—ˆëŠ”ì§€ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.  Attention ì´ì „ì—ëŠ” rnn ê³„ì—´ ëª¨ë¸ì´ linear transformation í›„ directly í•˜ê²Œ outputì„ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤ . ì™¼ìª½ì´ attention ì´ì „ì—  sequence outputì„ ê³„ì‚°í•˜ëŠ” ê³¼ì •ìž…ë‹ˆë‹¤. ìœ„ì˜ ì˜ˆì‹œëŠ” , ì˜ì–´ ë¬¸ìž¥ <code class="language-plaintext highlighter-rouge">milk drink I</code> ì—ì„œ ë¶ˆì–´ <code class="language-plaintext highlighter-rouge">je bois du lait</code> ë¥¼ ë²ˆì—­í•˜ëŠ” ê³¼ì •ìž…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">milk</code> ì—ì„œ ë¶€í„° <code class="language-plaintext highlighter-rouge">lait</code> ê¹Œì§€ êµ‰ìž¥ížˆ ì˜¤ëž˜ ê±¸ë¦¼ì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.  Attention ì•Œê³ ë¦¬ì¦˜ì€ <code class="language-plaintext highlighter-rouge">milk</code> ë¼ëŠ” ë‹¨ì–´ì˜ contextê°€ ì–´ë–»ê²Œ í•˜ë©´ <code class="language-plaintext highlighter-rouge">lait</code> ê¹Œì§€ ì§§ê²Œ ì „ë‹¬ë˜ê²Œ í• ê¹Œë¥¼ í•´ê²°í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ìž…ë‹ˆë‹¤. Attention ì•Œê³ ë¦¬ì¦˜ì€ <a href="https://arxiv.org/pdf/1409.0473.pdf">1409.0473.pdf (arxiv.org)</a> by<a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Bahdanau%2C+D">Dzmitry Bahdanau</a>, , <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Cho%2C+K">Kyunghyun Cho</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Bengio%2C+Y">Yoshua Bengio</a>. ì—ì„œ ì†Œê°œëœ ì•Œê³ ë¦¬ì¦˜ ìž…ë‹ˆë‹¤.  . ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì—ì„œ ë³´ë©´ , Decoderê°€ íŠ¹ì •í•œ input ë‹¨ì–´ì— attention í•˜ë„ë¡ modelì˜ architecutureë¥¼ ë§Œë“¤ìžëŠ” ê²ƒì´ ê·¸ë“¤ì´ ì†Œê°œí•œ ì•Œê³ ë¦¬ì¦˜ ìž…ë‹ˆë‹¤.  hidden state \(h(i)\) ê°€ weight  \(\alpha_{(t,i)}\) ì™€ì˜ operation ì„ í†µí•´ì„œ outputì´ ê³„ì‚°ì´ ë¨ì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.  weight  \(\alpha_{(t,i)}\) ëŠ”  <code class="language-plaintext highlighter-rouge">i-th</code> encoderì˜  <code class="language-plaintext highlighter-rouge">t-th</code> decoder ì—ì„œì˜ weightìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ , \(\alpha_{(3,2)}\) ëŠ” \(\alpha_{(3,0)}  , \alpha_{(3,0)}\) ë³´ë‹¤ attentionì„ ìƒëŒ€ì ìœ¼ë¡œ ë” í•˜ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³  , ë§¤ <code class="language-plaintext highlighter-rouge">t-th</code> ë§ˆë‹¤ decoderì—ì„œ encoderì˜ outputê³¼ hidden stateë¥¼ concatenate(additive)ë¥¼ í•  ê²ƒìž…ë‹ˆë‹¤.  Bahdanau  AttentionëŠ” TimeDistributed Layerë¥¼ ê±°ì¹˜ê¸° ë•Œë¬¸ì— , input sequenecê°€ nì´ë¼ê³  í•˜ë©´ \(O(n**2)\) ì˜ complexity ê³„ì‚°ì´ ë©ë‹ˆë‹¤ . output sequenceê°€ ë§¤ìš° ê¸¸ë‹¤ë©´ quadratic orderëŠ” criticalí•œë° , outputì´ ì²œë‹¨ìœ„ë¡œ ê³„ì‚°í• ë§Œí•˜ê¸°ì— í° ì˜í–¥ì€ ì—†ìŠµë‹ˆë‹¤.</p>

<p>ì´ì œ \(\alpha_{(t,i)}\) ë¥¼ ì–´ë–»ê²Œ ê³„ì‚°í•˜ëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ , \(\alpha_{(t,i)}\) ë¥¼ ê³„ì‚°í•  ë•Œ , hidden state \(h(t-1)\) ê³¼ \(\alpha_{(t,i)}\) ë¥¼ concatante í•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒì— , TimeDistributed(Dense Layer)(Time Distributedë¼ëŠ”ê²Œ matrixë¡œ ë³‘ë ¬ ì—°ì‚°ì„ ì˜ë¯¸í•˜ëŠ”ë“¯)ë¥¼ ê±°ì¹˜ë©´ì„œ \(e_{(t,i)}\)  ë¥¼ ê³„ì‚°í•˜ê²Œ ë©ë‹ˆë‹¤.  \(e_{(t,i)}\)   ëŠ” ì´ì „ì˜ hidden state ì™€ ì–¼ë§ˆë‚˜ alignment í•˜ëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” valueìž…ë‹ˆë‹¤. ( alignment scoreëŠ” ë‘ sequence ê°€ ìžˆì„ ë•Œ , ë‘ sequenceê°€ ì–´ëŠ ì •ë„ë¡œ ì—°ì†ì ì¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì ìˆ˜ì •ë„ë¡œ ìƒê°í•˜ì‹œë©´ íŽ¸í•©ë‹ˆë‹¤. <a href="https://www.gsic.titech.ac.jp/supercon/supercon2004-e/alignmentE.html">Alignment and Alignment Score (titech.ac.jp)</a>) ê·¸ ë‹¤ìŒì— , ì–´ëŠ \(y_{(i)}\) ì— ì¢€ ë” attentionì„ í• ì§€ ê°€ì¤‘ì¹˜ë¥¼ ë‘ê¸° ìœ„í•´ì„œ weighted sumì„ ê³„ì‚°í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ ë•Œ  softmaxë¥¼ ì´ìš©í•´ì„œ weighted sumì„  ê³„ì‚°í•©ë‹ˆë‹¤.ë©”ì¸ ì €ìž Bandanau ì˜ ì´ë¦„ì„ ë”°ì„œ , Bahdanau Attention í˜¹ì€ concatenate(additive) attention ì´ë¼ê³ ë„  ë¶ˆë¦¬ê¸°ë„ í•©ë‹ˆë‹¤ .</p>

<p>ì´ ì™¸ì—ë„ [<a href="https://arxiv.org/abs/1508.04025">1508.04025] Effective Approaches to Attention-based Neural Machine Translation (arxiv.org)</a> ì— ë…¼ë¬¸ì—ì„œ ë°œí‘œëœ  Luong eAttention ë„ ìžˆìŠµë‹ˆë‹¤.  Luong Attentionì€ simliarityë¥¼ êµ¬í•˜ëŠ”ê²Œ ëª©ì ì´ì˜€ê¸°ì— , TimeDistributed Layer(Dense) ëŒ€ì‹ ì— dotproductë¥¼ ì´ìš©í•´ì„œ similarityë¥¼ ê³„ì‚°í•˜ì˜€ ìŠµë‹ˆë‹¤. ì´ëŠ”Luong Attention , í˜¹ì€ multiplicative attentionì´ë¼ê³ ë„ ë¶ˆë¦½ë‹ˆë‹¤.  ê·¸ë“¤ì€ simliarity scoreë¥¼ ê³„ì‚°í•˜ê³  ì´ë¥¼ Bahdanau Attentionê³¼ ë§ˆì°¬ê°€ì§€ë¡œ softmax layerë¥¼ í†µí•´ì„œ \(\alpha_{(t,i)}\)  ë¥¼ ê³„ì‚°í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ë“¤ì˜ íŠ¹ì´í•œ ì ì€ decoderì˜ hidden stateë¥¼ \(h(t-1)\) ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ  \(h(t)\) ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ dotproduct ë°©ì‹ ì´ì™¸ì— TimeDistributed layerë¥¼ í†µê³¼ì‹œí‚¨ general ë°©ì‹ì„ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  , ì´ë“¤ì€ ì´ ë°©ë²•ì„ concatanate ë°©ì‹ê³¼ performanceë¥¼ ë¹„êµí•˜ì˜€ëŠ”ë°, dotproduct, general ë°©ì‹ì´ concatanate ë°©ì‹ë³´ë‹¤ performanceê°€ ë” ì¢‹ìŒì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ , í˜„ìž¬ëŠ” concatanateë°©ì‹ì€ ìž˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ , Transformerë„ dotproductë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ 3ê°€ì§€ë¥¼ ìˆ˜ì‹ìœ¼ë¡œ ìš”ì•½í•˜ë©´ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤._</p>

\[\begin{align}
\tilde {h(t)} &amp;= \sum_{i=1} {y_i \alpha_{(i,t)}} \\
\alpha_{(i,t)} &amp;= {\frac{exp{( e_{(i,t)})} }{\sum_{i=1}{exp{ (e_{(i,t)}) } }}} \\
e_{(i,t)} &amp;= \begin{cases}  h_{(t)} y_{(i)} &amp; \qquad dot  \\ h_{(t)}W y_{(i)} &amp; \qquad general \\ v^TW_a[h_{(t-1)};y_{(i)}] &amp; \qquad concatanate \end{cases}
\end{align}\]

<h3 id="self-attention">Self-Attention</h3>

<p><img src="https://user-images.githubusercontent.com/50165842/148861399-92bcde71-7df9-4ef0-bb30-8ed70f6f5eaa.png" alt="image" /></p>

<p>multiheadAttention ì€ AttenionisAllyouneed ë…¼ë¬¸ì—ì„œ ì†Œê°œëœ transformers ëª¨ë“ˆì„ ì´ë£¨ëŠ” ëª¨ë“ˆìž…ë‹ˆë‹¤.  .Attentionì— ëŒ€í•œ ì •ì˜ë¥¼ í•˜ê¸° ì•žì„œ , Attentionì´ ì–´ë– í•œ ì‹ìœ¼ë¡œ scoreë¥¼ ê³„ì‚°í•˜ëŠ”ì§€ ì˜ˆì‹œë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ,  {â€œì£¼ì–´â€ : â€œìµœì›…ì¤€â€ , â€œë™ì‚¬â€ : â€œë°¥ì„ ë¨¹ì—ˆë‹¤.â€ , â€œì–´ë””ì—ì„œâ€ : â€œì§‘ì—ì„œâ€} ì´ëŸ¬í•œ dictionary ê°€ ìžˆë‹¤ê³  ê°€ì •ì„ í•˜ê² ìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">ìµœì›…ì¤€ì€ ë°¥ì„ ë¨¹ì—ˆë‹¤.</code> ë¼ëŠ” ë¬¸ìž¥ì´ ë‚˜ì˜¤ë©´ ë‹¤ìŒì—ëŠ” <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code> ë¼ëŠ” ì •ë³´ê°€ ë‚˜ì™€ì•¼ í•  ê²ƒìž…ë‹ˆë‹¤. ì´ë¥¼ ì•Œê¸° ìœ„í•´ì„œ , ìš°ë¦¬ëŠ” dictionary ì—ì„œ <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code> ë¼ëŠ” keywordë¥¼ ì°¾ì„ ê²ƒì´ê³   , ê±°ê¸°ì—ì„œ <code class="language-plaintext highlighter-rouge">ì§‘ì—ì„œ</code>ë¼ëŠ” valueë¥¼ ì–»ì„ ê²ƒìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³ , <code class="language-plaintext highlighter-rouge">ìµœì›…ì¤€ì€ ë°¥ì„ ë¨¹ì—‡ë‹¤ ì§‘ì—ì„œ</code> ë¼ëŠ” ë¬¸ìž¥ì„ ì™„ì„±í•  ê²ƒìž…ë‹ˆë‹¤ .  ì—¬ê¸°ì—ì„œ , ì´ dictioary ì˜  key, value ê·¸ë¦¬ê³  , ë¬¸ë§¥ì„ ê³ ë ¤í•˜ëŠ” query ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´  multihead attentionì€ ì´ë£¨ëŠ” self-attention ëª¨ë“ˆìž…ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ, ì´ë¥¼ ë°”ë¡œ êµ¬í˜„í•˜ëŠ”ë° ì‚¬ìš©í•˜ê¸°ì—ëŠ” ë¬´ë¦¬ê°€ ìžˆìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´, attention ë‚´ë¶€ëŠ” vector representationì´ê¸°ì— , <code class="language-plaintext highlighter-rouge">ì£¼ì–´</code> , <code class="language-plaintext highlighter-rouge">ë™ì‚¬</code> ,<code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code> ë¼ëŠ” keyì¤‘ì—ì„œ <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code>ë¼ëŠ” keyë¥¼ ì„ íƒí•´ì„œ í™œìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´, ì´ vector representationì„ ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í• ê¹Œìš”? ì—¬ê¸°ì„œ , ë¬¸ë§¥ì  ì •ë³´ì¸ <code class="language-plaintext highlighter-rouge">query</code> ì™€ <code class="language-plaintext highlighter-rouge">key</code>ê°’ì˜ ìœ ì‚¬ë„ë¥¼ êµ¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ì–´ë–¤ <code class="language-plaintext highlighter-rouge">key</code>  ê°’ì—ì„œ ì¢€ ë” ê°€ì¤‘ì¹˜(attention)ì„ ë‘˜ì§€ ê²°ì •í•©ë‹ˆë‹¤. ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œ dot-productë¥¼ ì´ìš©í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒì—  , softmax í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì´ë¥¼ sum ì´ 1ì¸ ê°€ì¤‘ì¹˜ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì´ë¥¼ ì´ìš©í•´ì„œ , valueê°’ì„ ì–»ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code> ë¼ëŠ”  keyë¥¼ í‘œí˜„í•˜ëŠ” vectorì˜ weightê°€ 1ì— ê°€ê¹ê²Œ ë  ê²ƒì´ê³  , ë‚˜ë¨¸ì§€ëŠ” <code class="language-plaintext highlighter-rouge">ì£¼ì–´</code> , <code class="language-plaintext highlighter-rouge">ë™ì‚¬</code> ë¥¼ í‘œí˜„í•˜ëŠ” vectorì˜ weightëŠ” 0ì— ê°€ê¹ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤. ì´ì— ëŒ€í•œ weighted sumì„ ê³„ì‚°í•˜ê²Œ ë˜ë©´, <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code>  ì˜ valueê°’ì¸ <code class="language-plaintext highlighter-rouge">ì§‘ì—ì„œ</code> ë¥¼ ë‚˜íƒ€ë‚´ëŠ” vectorê°’ì— ê·¼ì‚¬í•˜ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤.  ì´ë¥¼ ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

\[Attention(Q,K,V) =  softmax({ {QK^T} \over { \sqrt{d_{keys}} } } )    \cdot V\]

<p>attention ìˆ˜ì‹ì— ëŒ€í•´ì„œ ì¢€ ë” ìžì„¸í•˜ê²Œ ì½”ë©˜íŠ¸ë¥¼ ë‹¬ì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<ul>
  <li>QëŠ” \([n_{queries}, d_{keys}]\) ì˜ shapeë¥¼ ê°–ëŠ” matrixìž…ë‹ˆë‹¤.</li>
  <li>KëŠ” \([n_{keys} ,d_{keys}]\) ì˜ shapeë¥¼ ê°–ëŠ” matrixìž…ë‹ˆë‹¤.</li>
  <li>VëŠ” \([n_{keys} , d_{values}]\) ì˜ shapeë¥¼ ê°–ëŠ”matrixìž…ë‹ˆë‹¤.</li>
  <li>matrix \(QK^T\) ì˜ shapeì€ \([n_{queries} :n_{keys} ]\) ìž…ë‹ˆë‹¤.  ê·¸ë¦¬ê³  , softmax functionì˜ outputë„ ê°™ì€ shapeì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  , ëª¨ë“  rowê°€ sumì´ 1ì„ ê°€ì§€ëŠ” weighted sumì˜ í˜•íƒœìž…ë‹ˆë‹¤.  \(QK^T\) ì˜ shapeì€ \([n_{queries} :d_{values} ]\) ê°€ ë©ë‹ˆë‹¤. ê° rowê°€ query 1ê°œì— ëŒ€í•œ resultë¼ ë´ë„  ë©ë‹ˆë‹¤.</li>
  <li>scaling factor \(\sqrt{d_{keys}}\) ëŠ” softmax ê°€ ì»¤ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ì—¬ ìž‘ì€ graident ê°’ì„ ê³„ì‚°í•´ì„œ updateí•  ìˆ˜ ìžˆë„ë¡ í•´ì¤€ë‹¤ê³  í•©ë‹ˆë‹¤.(ì™œ ê¼­ gradientì˜ í¬ê¸°ë¥¼ ë‚®ì¶°ì•¼í•˜ëŠ”ì§€ëŠ” ìž˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤.)</li>
  <li>ì‹¤ì œë¡œ , MaskedMultiheadAttentionì€ êµ¬í˜„í•  ë•Œ , decoderì— ìžˆëŠ” ê° self attentionì—ì„œ ì•„ì£¼ í° negative ê°’ì„ ë”í•´ì£¼ëŠ” techniqueë¥¼ ì‚¬ìš©í•˜ëŠ”ë° ì´ëŠ” ê½¤ ìœ ìš©í•©ë‹ˆë‹¤.</li>
</ul>

<p>ê·¸ë¦¬ê³  , transformersì—ì„œ ë³´ë©´ encoder, decoder íŒŒíŠ¸ê°€ ìžˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ì„œ , encoderëŠ” query, key ,value ê°€ ëª¨ë‘ ê°™ì€ input sentence ë¡œë¶€í„° ê³„ì‚°ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.ë˜í•œ , decoder ë„ target sentence ë¡œ query,key,valueë¥¼ ê³„ì‚°í•˜ê²Œ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, decoderì˜ ê²½ìš° \(P(y_{t} \vert y_{&lt;t})\) ë¥¼ ê³„ì‚°í•´ì•¼ í•˜ê¸°ì—  , ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ , ì•„ì£¼ í° negtaive ê°’ì„ ì´ìš©í•´ì„œ softmax ê°’ì„ ê³„ì‚°í•  ë•Œ ë’¤ì˜ ê°’ë“¤ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ì— ê°€ê¹ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ,Decoderì—ì„œ MultiheadAttention Layerê°€ ë‚˜ì˜¤ëŠ”ë° , K,VëŠ” encoderì—ì„œ ë§Œë“¤ì–´ì§„ vector representation(dictionary) ë¥¼ ì‚¬ìš©í•˜ê³  , QëŠ” maskedmulitheadattentionì—ì„œ ê³„ì‚°í•œ vector ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<h3 id="multihead-attention">Multihead-attention</h3>

<p><img src="https://user-images.githubusercontent.com/50165842/148869343-08d9b859-0a3d-4438-9015-4002213dfc61.png" alt="image" /></p>

<p>ê·¸ëŸ¼ ì™œ , attentionì„ 1ê°œê°€ ì•„ë‹Œ ì—¬ëŸ¬ê°œì˜ attentionì„ ì‚¬ìš©í• ê¹Œìš”? ì˜ˆë¥¼ ë“¤ì–´ì„œ , ì„¤ëª…í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">ìµœì›…ì¤€ì€ ì§‘ì—ì„œ ì§‘ì¤‘ì´ ì•ˆë˜ì„œ ì¹´íŽ˜ì— ê³µë¶€í•˜ëŸ¬ ê°”ë‹¤ . </code> ì´ë¼ëŠ” ë¬¸ìž¥ì´ ìžˆìŠµë‹ˆë‹¤. ì´ ë•Œ ,   {â€œì£¼ì–´â€ : â€œìµœì›…ì¤€â€ , â€œë™ì‚¬â€ : â€œê³µë¶€í•˜ëŸ¬ ê°”ë‹¤.â€ , â€œì–´ë””ì—ì„œâ€ : â€œì¹´íŽ˜ì—â€}   ì´ëŸ¬í•œ dictionaryê°€ ë§Œë“¤ì–´ ì§ˆ ê²ƒìž…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">ì–´ë””ì—ì„œ</code> ë¼ëŠ” keyê°’ì— ëŒ€í•´ì„œ <code class="language-plaintext highlighter-rouge">ì¹´íŽ˜ì—</code> ë¼ëŠ” valueê°’ì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">ì¹´íŽ˜ì— ì™œ ê°”ì–´</code> ë¼ëŠ” keyê°’ì— ëŒ€í•´ì„œëŠ” ê¸°ì¡´ì˜ dictionaryë¡œ ë‹µì„ í•  ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤. ë¬¸ìž¥ì—ëŠ” ì´ ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œì˜ ë§¥ë½ì ì¸ ì •ë³´ë“¤ì´ ë‹´ê²¨ìžˆìŠµë‹ˆë‹¤. 1ê°œì˜ attention ë§Œìœ¼ë¡œëŠ” 1ê°€ì§€ ì¸¡ë©´ì˜ ì •ë³´ë§Œì„ ë‹´ì„ ìˆ˜ ë°–ì— ì—†ì„ ê²ƒìž…ë‹ˆë‹¤. ë”°ë¼ì„œ, ì—¬ëŸ¬ê°œì˜ attentionìœ¼ë¡œ ì—¬ëŸ¬ê°œì˜ vector spaceì— projectionì„ í•´ì„œ sequenceì˜ ë‹¤ì–‘í•œ ì •ë³´ë“¤ì„ í‘œí˜„í•˜ê³ ìž í•©ë‹ˆë‹¤.</p>

<h2 id="why-attention-weighted-sum---detailed">Why Attention Weighted Sum? -&gt; Detailed</h2>

<p>Attentionì´ ì™œ weighted sumì„ ê³„ì‚°í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ì•„ì§ ì„¤ëª…í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.  ì—°êµ¬ìžë¶„ë“¤ì´ ë§Œë“¤ë•Œ ê·¸ëƒ¥ í•´ë³´ê³  ì¢‹ì•„ì„œ ë§Œë“¤ì–´ì§„ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤. ì´ì— ëŒ€í•´ ì•Œê¸° ìœ„í•´ì„œëŠ” ì‚¬ëžŒì˜ ë‡Œê°€ ì–´ë–»ê²Œ ê¸°ì–µì„ í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œ ì•Œì•„ì•¼í•©ë‹ˆë‹¤.</p>

<p>ì‚¬ëžŒì€ ì• ë§¤ëª¨í˜¸í•˜ê³  , ë¬´ì˜ì‹ì˜ ì˜ì—­ì— ìžˆìœ¼ë©´ì„œ, êµ‰ìž¥ížˆ ë³µìž¡í•œ êµ¬ì¡°ì˜ memoryë¥¼ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, <code class="language-plaintext highlighter-rouge">ì‚¬ëžŒì´ ê±·ëŠ” ë°©ë²•</code> , <code class="language-plaintext highlighter-rouge">ì‚¬ëžŒì´ ìž¬í‚·ì„ ìž…ëŠ” ê³¼ì •</code> ì´ ìžˆìŠµë‹ˆë‹¤. ì´ memoryë“¤ì€ ìš°ë¦¬ê°€ ì¼ìƒìƒí™œì„ í•˜ë©´ì„œ ìžì—°ìŠ¤ëŸ½ê²Œ í•˜ëŠ” ë¬´ì˜ì‹ì¸ í–‰ë™ë“¤ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ, ì´ memoryë“¤ì„ ê¹Šê²Œë³´ë©´ êµ‰ìž¥ížˆ ë³µìž¡í•˜ê¸° ë•Œë¬¸ì— , ì• ë§¤ëª¨í˜¸í•œ ê¸°ì–µë“¤ìž…ë‹ˆë‹¤. ì‚¬ëžŒì´ ì˜ì‹í•˜ë©´ì„œ ê¸°ì–µí•˜ì§€ ëª»í•˜ê¸°ì—  implicit memoryë¼ ë¶ˆë¦½ë‹ˆë‹¤. ë°˜ë©´ì— ,  êµ‰ìž¥ížˆ ëšœë ·í•˜ê³  , ëª…ì‹œì ì¸ ê¸°ì–µë“¤ì´ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ , <code class="language-plaintext highlighter-rouge">ì½œë¼</code> ,<code class="language-plaintext highlighter-rouge">ì‚¬ê³¼</code> ëŠ” ëª…í™•í•œ ì´ë¯¸ì§€ë¥¼ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³ , <code class="language-plaintext highlighter-rouge">ì•„ì¹¨ 8ì‹œì— ì•½ì„ ë¨¹ì–´ì•¼í•œë‹¤</code> ë„ ì‚¬ëžŒì´ ì˜ì‹ì ìœ¼ë¡œ ê¸°ì–µì„ í•˜ë©´ì„œ í•˜ëŠ” í–‰ë™ìž…ë‹ˆë‹¤.ì‚¬ëžŒì´ ì˜ì‹ì„ í•˜ë©´ì„œ ê¸°ì–µí•  ìˆ˜ ìžˆê¸°ì— explicit memoryë¼ ë¶ˆë¦½ë‹ˆë‹¤.(implicit memory , explicit memory ì— ëŒ€í•œ ì •í™•í•œ ì„¤ëª…ì€ ì•„ë‹ˆì§€ë§Œ conceptë§Œì„ ìž¡ê¸°ìœ„í•´ ëŒ€ëžµì ì¸ ì°¨ì´ì ë§Œ ì–¸ê¸‰ì„ í•©ë‹ˆë‹¤.)</p>

<p>Neural NetworkëŠ” implicit memoryë¥¼ ì €ìž¥í•˜ëŠ”ë° íŠ¹í™”ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, explicit memoryë¥¼ ì €ìž¥í•˜ëŠ”ë°ëŠ” ë§Žì´ ë¶€ì¡±í–ˆìŠµë‹ˆë‹¤ . Stochastic Gradient DescentëŠ” inputì„ feedforwardë¡œ ê³„ì‚°í•˜ê³  ì´ ë‚´ìš©ì´ ë°”ë¡œ ì €ìž¥ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ layerë¥¼ ê±°ì¹œë‹¤ìŒì— updateê°€ ë©ë‹ˆë‹¤. ì´ inputë“¤ì€ hidden layerë¥¼ ê±°ì¹˜ë©´ì„œ ë‹¤ë¥¸ hidden layerì˜ inputìœ¼ë¡œ ë“¤ì–´ê°€ê¸°ì— , ì›ëž˜ì˜ inputê³¼ ë‹¬ë¼ì§€ê³  , ë‚˜ì¤‘ì— gradient descentë¥¼ ê³„ì‚°í•´ì„œ updateí•  ë•ŒëŠ” ê·¸ ìˆœê°„ì˜ inputì •ë³´ê°€ update ë˜ì§€ëŠ” ì•Šì„ ê²ƒìž…ë‹ˆë‹¤.(DeepLearning Bookì˜ êµ¬ì ˆì„ ì œê°€ ë‚˜ë¦„ëŒ€ë¡œí•´ì„í•´ë´¤ëŠ”ë° ë§žëŠ”ì§€ëŠ” ëª¨ë¥´ê²Ÿë„¤ìš”.ì›ë¬¸ì—ì„œ 10.12 418pg ì— í•´ë‹¹í•˜ëŠ” êµ¬ì ˆì„ ì œê°€ í•´ì„í•´ë´¤ìŠµë‹ˆë‹¤.) . <a href="https://arxiv.org/pdf/1410.5401.pdf">Nueral Turing Machine</a>  ì—ì„œëŠ” ì´ë¥¼ ì‚¬ëžŒê³¼ ê°™ì€ working memoryì˜ ë¶€ìž¬ë¡œ ìƒê¸°ëŠ” ë¬¸ì œì ì´ë¼ ì£¼ìž¥í•©ë‹ˆë‹¤.</p>

<h3 id="working-memory">Working Memory?</h3>

<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRurJWypZIrq1oBcsypUfLwEMJwk813BrjcsA&amp;usqp=CAU" alt="A Blackboard Full of Mathematical Formulas. Educational Concept Background  Stock Image - Image of complicated, education: 174283309" /></p>

<p>Working MemoryëŠ” ì‚¬ëžŒì´ í•™ìŠµì„ í•˜ê²Œë˜ë©´ ì¼ì‹œì ìœ¼ë¡œ ê¸°ì–µì´ ì €ìž¥ë˜ëŠ” ìž¥ì†Œìž…ë‹ˆë‹¤.ì œê°€ ì¹ íŒ ê·¸ë¦¼ì„ ê°€ì ¸ì™”ëŠ”ë° , Working BoardëŠ” BlackBoardì™€ ìœ ì‚¬í•œ ì„±ì§ˆì„ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤. ì„ ìƒë‹˜ì´ ìˆ˜ì—…ì„ ê°€ë¥´ì¹  ë•Œ , ì–´ë–¤ ë‚´ìš©ì„ ì¹ íŒì— ì ì–´ì„œ í•™ìƒë“¤í•œí…Œ ì„¤ëª…ì„ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³ ,ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ë‹¤ë¥¸ ë‚´ìš©ì„ ì ê²Œë©ë‹ˆë‹¤. ê·¸ ì´ì „ ë‚´ìš©ì€ , ì„ ìƒë‹˜ì´ ì§€ìš°ê°œë¡œ ì§€ìš¸ê²ƒìž…ë‹ˆë‹¤.  ì‚¬ëžŒì´ ê³µë¶€ë¥¼ í•  ë•Œë„ , ê·¸ ìˆœê°„ì— ê³µë¶€í•œ ê²ƒì€ ê¸°ì–µì´ ë‚˜ì§€ë§Œ, ì‹œê°„ì´ ì§€ë‚˜ë©´ ì§€ë‚  ìˆ˜ë¡ ê¹Œë¨¹ê²Œ ë©ë‹ˆë‹¤.</p>

<p>ì‚¬ëžŒì€ ê·¸ ìˆœê°„ì˜ working memoryë¥¼ ì´ìš©í•´ì„œ ë‹¤ìŒ í–‰ë™ì„ ì–´ë–»ê²Œ í• ì§€ ê²°ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. working memoryì—ì„œ ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ì§€ , working memoryì— ì–´ë– í•œ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ê¸°ë¡í• ì§€ ë§¤ ìˆœê°„ ê²°ì •í•©ë‹ˆë‹¤. ì‚¬ëžŒì´ inputì´ ë“¤ì–´ì˜¤ë©´ ìžë™ì ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ”ê²Œ ì•„ë‹Œ, ì¶”ë¡ ì„ í•˜ê³  í–‰ë™í•˜ëŠ” ëŠ¥ë ¥ì´ ìžˆìŠµë‹ˆë‹¤. neural netì—ê²Œ ì´ëŸ¬í•œ ëŠ¥ë ¥ì„ ì¤„ ìˆ˜ ì—†ì„ê¹Œ í•˜ê³  ë‚˜ì˜¨ê²Œ Memory Cellìž…ë‹ˆë‹¤.</p>

<h3 id="memory-cell">Memory Cell</h3>

<p><img src="https://user-images.githubusercontent.com/50165842/148873967-48e6136a-6c62-4bcd-9693-7a64bcd72568.png" alt="image" /></p>

<p>ê·¸ë¦¼ì„ ë³´ì‹œë©´, Neural Netì´ ìžˆê³  , Neural Netì´ ì–´ë–¤ taskë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ì„œ , ì™¸ë¶€ inputì´ ë“¤ì–´ì˜¤ë©´ controller(nueral net) ì´ memoryì—  ì“°ê¸°ë„ í•˜ê³  , outputì„ ë‚´ì•¼í• ë•Œ memoryë¥¼ ì½ê³  outputì„ ë‚´ê¸°ë„ í•©ë‹ˆë‹¤. Ian Goodfellowê°€ ë™ì˜ìƒì—ì„œ ì„¤ëª…í•˜ëŠ”ë¶€ë¶„ì´ ìžˆëŠ”ë° ì¢‹ì€ ì˜ˆì œì¸ê±° ê°™ì•„ì„œ ì´ ì˜ˆì‹œë„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ,ì œê°€ ë‚´ì¼ ì˜¤ì „ 8ì‹œ 30ë¶„ì— ë§¤ì£¼ ìžˆëŠ” ì •ê¸°ì ì¸ ë…ì„œëª¨ìž„ì„ ë‚˜ê°€ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆ , Ianì˜ meorycellì—ì„œ  â€œë‚´ì¼ ì˜¤ì „ 8ì‹œ 30ë¶„ ë…ì„œëª¨ìž„â€ ì— gating function(actviation function)ì´ 1ë¡œ í™œì„±í™”ê°€ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ê°‘ìžê¸°, ì˜¤ëŠ˜ ì˜¤í›„ 9ì‹œì— ë‚˜ì˜ bossí•œí…Œì„œ ì—°ë½ì´ ì˜µë‹ˆë‹¤. â€œIan, ë‚´ì¼ íˆ¬ìž ì„¤ëª…íšŒì— ì°¸ê°€í•´ì•¼í•˜ë‹ˆê¹Œ ì˜¤ì „ 9ì‹œì—â€ , â€œoh my godâ€, ê·¸ëŸ¬ë©´ì„œ, Ianì˜ memory cellì˜ â€œë‚´ì¼ ì˜¤ì „ 8ì‹œ 30ë¶„ ë…ì„œëª¨ìž„â€  ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì—ì„œ gating function(actviation function)ì´ 0ìœ¼ë¡œê°€ê¹Œì›Œì§€ê³  , â€œë‚´ì¼ ì˜¤ì „ 9ì‹œ íšŒì˜â€ ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì˜ gating function(activation function) ì´ 1ë¡œ ê°€ê¹Œì›Œì§€ê²Œ ë©ë‹ˆë‹¤. ì¦‰, memory cellì—ì„œ inputìœ¼ë¡œ ë“¤ì–´ì˜¤ë©´ì„œ writingì„ í•˜ëŠ”ë°, input ì— ë”°ë¼ activationì´ 1ì— ê°€ê¹Œì›Œì§€ê¸°ë„ 0ì— ê°€ê¹Œì›Œì§€ê¸°ë„ í•©ë‹ˆë‹¤. external outputì´ í•„ìš”í•  ë–„ëŠ” memoryë¥¼ ì½ìŠµë‹ˆë‹¤. ì´ task networkëŠ” ì–´ë–»ê²Œ memoryë¥¼ <code class="language-plaintext highlighter-rouge">control</code> í•˜ëŠ”ì§€ë¥¼ <code class="language-plaintext highlighter-rouge">í•™ìŠµ</code> í•©ë‹ˆë‹¤. ì–´ë–¤ memoryë¥¼ í™œì„±í™” ì‹œí‚¤ê³ , ë‹¤ë¥¸ memoryì— ë”°ë¼ ë‹¤ë¥¸ ê¸°ì–µë“¤ì´ ë¹„í™œì„±í™” ë  ìˆ˜ë„ ìžˆì–´ì•¼í•˜ê¸°ì— softmaxë¥¼ ì‚¬ìš©í–ˆë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.</p>

<p>ì²˜ìŒì— ì´ëŸ¬í•œ ì‹œë„ë¥¼ Memory Networkë¼ëŠ” architectureìœ¼ë¡œ ì‹œë„ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤.  í•˜ì§€ë§Œ Memory NetworkëŠ” ì´ëŸ¬í•œ memoryë¥¼ ì–´ë–»ê²Œ ì“¸ì§€ì— ëŒ€í•´ì„œ supervised Learningìœ¼ë¡œ í•™ìŠµì„ í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ë¥¼ ë³´ì™„í•´ì„œ neural turing machineì´ë¼ëŠ” architectureê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤. neural turing machineì€ memory cellì—ëŒ€í•œ supervised signal ì—†ì´ end-to-endë¡œ í•™ìŠµì´ ê°€ëŠ¥í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ neural turing machine ì€ content-based soft-attention mechainismì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ soft-attention mechanismì€ gradient descent optimizationì€ í—ˆìš©í–ˆê¸°ì— 2015ë…„ ëŒ€ì—ë¶€í„° standard í•œ architecutureê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ì´ Memory Cellì€ GRU, LSTM architectureì˜  cell stateê°€ vectorë¡œ í™•ìž¥ë˜ì—ˆë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. GRU, LSTMë„ vectorì¸ë° , vectorë¡œ í™•ìž¥ë˜ì—ˆë‹¤ëŠ” í‘œí˜„ì´ ì´ìƒí•˜ê²Œ ë“¤ë¦´ ìˆ˜ ìžˆë‹¤.cell stateì—ì„œ ëŠ” scalarì˜ setì´ì§€ë§Œ, Memory Cellì€ vectorì˜ setì´ë‹¤. GRU,LSTMê³¼ Memory cellì˜ ì°¨ì´ì ì€ memory ì—  read and writeë¥¼ ë¬´ì—‡ì„ í• ì§€ ê²°ì •ì„ í•˜ëƒ ì•ˆí•˜ëƒì˜ ì°¨ì´ìž…ë‹ˆë‹¤. ì´ëŠ” , ë§ˆì¹˜ computer ê°€ memory addressê°’ì„ ë°›ê³  memoryì— accessí•˜ëŠ” ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ ìž…ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´, ì™œ ë„ëŒ€ì²´ cell stateì—ì„œ ë” í° ìš©ëŸ‰ì˜ vectorë¥¼ ì‚¬ìš©í•˜ê²Œ ëœ ê²ƒì¼ê¹Œ?</p>

<h3 id="why-memory-cell-use-vector">Why Memory Cell use vector?</h3>

<h4 id="soft-alignment">soft-alignment</h4>

<p><img src="https://user-images.githubusercontent.com/50165842/154868602-0d267e51-2917-4cb7-92f0-bd13984b85d4.png" alt="image" /></p>

<p>Memory Cellì€ address Location  ë°©ì‹ìœ¼ë¡œ ì°¸ì¡°ë¥¼ í•˜ê²Œ ë˜ëŠ”ë° , ì´ ë•Œ ê¸°ì¡´ì˜ ë°©ì‹ìœ¼ë¡œëŠ” read ì™€ writeë¥¼ í•  integer addressë¥¼ ì •í™•í•˜ê²Œ ê·¼ì‚¬(approximation) í•˜ê¸°ê°€ ì–´ë ¤ì› ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ , Memory Cellì—ì„œ read , writeë¥¼ ë™ì‹œì— í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì´ë¥¼ í•´ê²°í•˜ê³ ìž í–ˆìŠµë‹ˆë‹¤. ë™ì‹œì— ,ëª¨ë“  memory addressë¥¼ ì½ê³  ê°€ìž¥ ê°€ëŠ¥ì„±ì´ ë†’ì€ addressì— accessë¥¼ í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì¦‰, Readë¥¼ í•˜ê¸° ìœ„í•´ì„œ weighted averageìœ¼ë¡œ memoryì—ì„œ ê°’ì„ ì½ê³   ê° memoryì— ë‹¤ë¥¸ ê°’ì„ write í–ˆìŠµë‹ˆë‹¤. memory ì— operationì„ í•˜ê¸° ìœ„í•œ coefficientë¡œ ìž‘ì€ ìˆ˜ì˜ memoryì— ì§‘ì¤‘ì„ í•˜ê²Œ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤. ì´ ë•Œ  , softmax functionì„ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ , non-zero deriativeë¥¼ í†µí•´ì„œ graident descentë¥¼ í†µí•´ì„œ optimizationì„ í•˜ê²Œ ë©ë‹ˆë‹¤. coefficientì˜ gradient ëŠ” ì–´ë–¤ weightë¥¼ í‚¤ìš¸ì§€ ,ì¤„ì¼ì§€ë¥¼ ì •í•˜ì§€ë§Œ ,  coefficientê°€ í° ê°’ì— í•´ë‹¹í•˜ëŠ” rowëŠ” gradientê°€ ì»¤ì§€ê¸°ì— , ì´ì— ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤.</p>

<p>ì´ë¥¼ ì¢€ë” detail í•˜ê²Œ ì„¤ëª…í•˜ë©´ hard-alignment ì™€ soft-alignmentì˜ ì°¨ì´ë¼ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì™¼ìª½ì€ hard-alignmentë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ê³  , ì˜¤ë¥¸ìª½ì€ soft-alignmentë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ attention scoreë¥¼ ê³„ì‚°í•˜ëŠ” moduleìž…ë‹ˆë‹¤. ë‘ ë°©ì‹ ëª¨ë‘ alignment vectorë¥¼ softmaxë¡œ ê³„ì‚°í•˜ëŠ” ê³µí†µì ì´ ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, hard-alginment ë°©ì‹ì„ ì‚¬ìš©í•˜ê²Œ ì–´ë–¤ ë‹¨ì–´ì˜encoding stateë¥¼ í•´ì¤˜ì•¼ í• ì§€ hard-codingìœ¼ë¡œ labelingì„ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ , soft-alignment ë°©ì‹ì€ weighted-sumì„ êµ¬í•˜ê¸°ì— hard-codingìœ¼ë¡œ labeling(alignment)ë¥¼ í•´ì¤˜ì•¼í•  í•„ìš”ê°€ ì—†ê²Œ ë©ë‹ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ , ì£¼ëª©í•  ì ì€ alignment vectorë¥¼ ì§ì ‘ hard-codingìœ¼ë¡œ desiredí•œ outputì„ ì§€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ëŠ” ì´ë¥¼ ë”ì´ìƒ latent variableë¡œì¨ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì¦‰, ì‰½ê²Œ ë§í•˜ìžë©´ ë³„ê°œì˜ parameterë¥¼ ê°€ì§„ í™•ë¥ ë¶„í¬ë¡œì¨ encoder-decoder modelê³¼ ë³„ê°œë¡œ ê³ ë ¤í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ , ì „ì²´ ëª¨ë¸ê³¼ í•¨ê»˜ gradient descentë¡œ trainì´ ê°€ëŠ¥í•´ì¡ŒìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>

<h4 id="computation-cost-reduced">computation cost reduced</h4>

<p>ìœ„ì˜ ì–˜ê¸°ê°€ Memory Cellì´vectorë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒê³¼ ë¬´ìŠ¨ ìƒê´€ì¸ê°€ ë¼ê³  ìƒê°ì´ ë“œì‹¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. Memory Cellì„ vectorì˜ setìœ¼ë¡œ ì‚¬ìš©í•œ ì²«ë²ˆì§¸ ì´ìœ ëŠ” ì´ë¯¸ ë™ì‹œì— readí•˜ë„ë¡(weighted average) computation costë¥¼ ëŠ˜ë ¸ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì´ë¯¸ , computation costê°€ ì•½ \(O(N^2)\) ë¡œ ëŠ˜ì–´ë‚¬ê¸°ì— , vectorë¥¼ readí•¨ìœ¼ë¡œì¨ ì´ ë¹„ìš©ì„ ìƒì‡„ì‹œí‚¨ë‹¤ê³  í•©ë‹ˆë‹¤. (ì´ <del>ë¶€ë¶„ì´ ì¢€ ì• ë§¤í–ˆìŠµë‹ˆë‹¤. ì‹œê°„ì„ ë“¤ì—¬ì„œ ê³ ë¯¼ì„ í•´ë´¤ëŠ”ë° , neural turing machine , NTMì—ì„œëŠ” shape (N,M) íŠ¹ì • ìœ„ì¹˜ë¥¼ approximation í•˜ì§€ ì•Šê³  , ë™ì‹œì— readí•´ì„œ weighted aveargeë¥¼ êµ¬í•˜ëŠ” ë°©ì‹ì´ì˜€ìŠµë‹ˆë‹¤. ì•žì—ì„œ , ë¬¸ì œì ìœ¼ë¡œ ì–¸ê¸‰í•œê²Œ ì •í™•í•œ integer addressë¥¼ íŠ¹ì •í•˜ëŠ” ê²ƒì´ì˜€ìŠµë‹ˆë‹¤.ì •í™•í•˜ê²Œ íŠ¹ì •í•˜ëŠ” ë¶€ë¶„ì´ sequential  ì—°ì‚°ì´ê³  , vectorê°’ìœ¼ë¡œ ì½ìœ¼ë©´ ë³‘ë ¬ ì—°ì‚°ìœ¼ë¡œ matrix multiplicationì„ í•˜ê¸°ì— ê³„ì‚°ìƒì˜ ë¹„ìš©ì„ ì¢€ë” ìƒì‡„ì‹œì¼°ë‹¤ëŠ” ë§ ê°™ìŠµë‹ˆë‹¤.</del> )</p>

<p>original paper[1]ì˜ A.1.2 í•­ëª©ì„ ë³´ë©´ ì´ì— ëŒ€í•œ ì„¤ëª…ì´ ë‚˜ì™€ìžˆìŠµë‹ˆë‹¤.<br />
\(\begin{align} a(s_{i-1} , h) = e_{ij} = v_a^T \tanh (W_as_{i-1} + U_ah_{j}) \end{align}\)</p>

<p>ë³´í†µì€ decoderì˜ hidden state s ì™€ encoderì˜ hidden state hë¥¼ concatenateí•´ì„œ ê³„ì‚°ì„ í•œë‹¤ í•˜ëŠ”ë° , ë…¼ë¬¸ì—ì„œëŠ” encoder ì˜ hidden state ë¥¼ Uë¼ëŠ” matrixë¥¼ ì´ìš©í•´ì„œ ë¯¸ë¦¬ precomputationì„ í•œë‹¤ê³  í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´, timestep iì— dependentí•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ëª¨ë“  timestepì— ëŒ€í•´ì„œ ë¯¸ë¦¬ ê³„ì‚°ì„ í•´ë†“ê³  ì‚¬ìš©í•˜ë¯€ë¡œ compute costë¥¼ ì¤„ì¸ë‹¤ëŠ” ì˜ë¯¸ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.(ì±…ì˜ ì €ìžê°€ yousha bengioì´ê¸° ë•Œë¬¸ì— ë…¼ë¬¸ì—ì„œ ê·¼ê±°ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.) . computation costë¥¼ ìƒì‡„ì‹œí‚¨ë‹¤ëŠ” ì˜ë¯¸ëŠ” ì•„ë§ˆë„ ê¸°ì¡´ì˜ hard-alignment ë°©ì‹ê³¼ ëŒ€ì¡°í•´ì„œ ì„¤ëª…í•œê±° ê°™ìŠµë‹ˆë‹¤. ê¸°ì¡´ì˜ hard-alignmentëŠ” ë§¤ time-stepë§ˆë‹¤ fully-connected layerì— concatenated í•´ì„œ inputìœ¼ë¡œ ì£¼ì–´ì„œ outputì„ ê³„ì‚°í•´ì•¼ í•˜ë¯€ë¡œ , timestepì— dependentí•˜ê¸°ì— ì‹œê°„ì´ ìƒëŒ€ì ìœ¼ë¡œ ë” ì˜¤ëž˜ê±¸ë¦°ë‹¤ê³  ì„¤ëª…í•˜ëŠ”ê±° ê°™ìŠµë‹ˆë‹¤ .</p>

<h4 id="content-based">content-based</h4>

<p>ë‘ë²ˆì§¸ë¡œëŠ” ,content-based readingì„ í•˜ê¸° ìœ„í•´ì„œìž…ë‹ˆë‹¤.  ê¸°ì¡´ì˜  LSTM, GRU <code class="language-plaintext highlighter-rouge">cell state</code>ëŠ” ëª¨ë“  ë¬¸ì„œì˜ ì •ë³´ì—ì„œ ì–´ë–¤ íŠ¹ì •í•œ patternì— ì¼ì¹˜í•˜ëŠ” ë¬¸ì„œë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤. sigmoidë¥¼ í†µí•´ ê·¸ì € ê°’ì´ í¬ë©´ ê°€ì¤‘ì¹˜ë¥¼ ì˜¬ë¦¬ê³  ê°’ì´ ë‚®ìœ¼ë©´ ê°€ì¤‘ì¹˜ë¥¼ ë‚®ì¶¥ë‹ˆë‹¤. í•˜ì§€ë§Œ, memory networkëŠ”  ì–´ë–¤ patternì— ë¶€í•©í•˜ëŠ” ì •ë³´ë¥¼ ì°¾ì„ì§€ ì„ íƒí•˜ê¸° ë•Œë¬¸ì—(coefficient , weighted average) ëª‡ëª‡ ë¬¸ì„œë§Œì„ ì¡°íšŒí•´ì„œ ì •ë³´ë¥¼ ì°¾ìŠµë‹ˆë‹¤.(key,value dictionary).  ì˜ˆë¥¼ ë“¤ì–´ , <code class="language-plaintext highlighter-rouge">ì½”ë¡œë‚˜</code> ë¼ëŠ” ë‹¨ì–´ê°€ ë“¤ì–´ê°„ ë¬¸ì„œë¥¼ ì°¾ê¸° ìœ„í•´ì„œëŠ” <code class="language-plaintext highlighter-rouge">ì½”ë¡œë‚˜</code> ë¼ëŠ” keywordì— ê·¸ë£¨í•‘ ë˜ì–´ ìžˆëŠ” ë¬¸ì„œë“¤ë§Œì„ ê²€ìƒ‰ í•  ê²ƒìž…ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ, location basedëŠ” content ë¥¼ ì°¸ì¡°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ê²ƒì€ , <code class="language-plaintext highlighter-rouge">ë¬¸ì„œí•¨ 347ë²ˆì§¸ì— ìžˆëŠ” ë¬¸ì„œë¥¼ ê°€ì ¸ì™€ë¼</code> ë¼ëŠ” ê²ƒê³¼ ìœ ì‚¬í•˜ê²Œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>

<p>ì´ë¥¼ Transformersì—ì„œ MultiheadAttentionì—ì„œ ë¹„ìœ í•˜ë©´ Decoderì—ì„œ multiheadattetntionì´ 
\(softmax(QK^T)\) 
ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤. Transformerì—ì„œë„ Decoderê°€ time step tì—ì„œ ì–´ë–¤ ì •ë³´ë¥¼ ê°–ê³ ìžˆì„ì§€ë¥¼ vectorë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.Transformerì—ì„œ Memory cellì— ëŒ€ì‘ë˜ëŠ” ê²ƒì´ Vë¼ ë³¼ìˆ˜ ìžˆê³  , ì´ì— ëŒ€í•œ weighted averageë¥¼ êµ¬í•˜ê¸° ìœ„í•œ matrixê°€ 
\(softmax(QK^T)\) 
ë¼ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. Transformerì—ì„œë„ Vì—ì„œ ê°€ìž¥ ê´€ë ¨ì´ ë†’ì€ contentì˜ addressë¥¼ ì°¾ëŠ” ê²ƒì´ ì•„ë‹Œ weighted averageë¥¼ êµ¬í•¨ì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.</p>

<h2 id="attention-in-optimization-view">Attention in optimization view</h2>

<p>attentionì´ ë¬´ì—‡ì´ê³  , attentionì—ì„œ ì™œ hidden layer outputìœ¼ë¡œ softmax ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆëŠ”ì§€ ê·¸ë¦¬ê³  weighted sumì„ ì™œê³„ì‚°í•˜ëŠ”ì§€, ê·¸ë¦¬ê³  ì–´ì§¸ì„œ \(Attention(Q,K,V) =  softmax({  {QK^T} \over {\sqrt{d_{keys}}}  })    \cdot V\) 
ì˜ í˜•íƒœë¡œ QK , Vë¥¼ matrix multiplicationì„ í–ˆëŠ”ì§€ ì•Œì•„ ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ”, gradient optimization ê´€ì ì—ì„œ ê¸°ì¡´ì˜ LSTM,GRUë³´ë‹¤ ì–´ë–¤ ì´ì ì´ ìžˆëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. Explicit memoryê°€  LSTM,GRUì™€ëŠ” ë‹¤ë¥´ê²Œ ìƒëŒ€ì ìœ¼ë¡œ propagationì´ ìž˜ ë˜ê³ , backpropagationì´ ìž˜ ë©ë‹ˆë‹¤. hidden layerë¥¼ ê±°ì¹˜ë©´ì„œ cell stateê°€ LSTM, GRU ê¸°ë°˜ì˜ seq2seq ì—ì„œëŠ” ë§Žì€ layerë¥¼ í†µê³¼í•˜ê¸°ì— gradientê°€ explode ë˜ê±°ë‚˜ vanishing ë  í™•ë¥ ì´ ë†’ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ,Explicit memoryëŠ” attention mechanismì„ ì ìš©í•´ì„œ ê°  outputì— ëŒ€í•˜ì—¬ gradient ê³„ì‚°ì´ ê°€ëŠ¥í•˜ê¸°ì— , contextë¥¼ weighted averageë¡œ ê³„ì‚°í•˜ì§€ ì•Šê³  directly í•˜ê²Œ ê³„ì‚°í•˜ëŠ” GRU, LSTM seq2seqê³¼ëŠ” ë‹¤ë¥´ê²Œ ,gradient descent ë¥¼ ì´ìš©í•´ì„œ í•™ìŠµì„ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.(respectively long duration )</p>

<h1 id="reference">Reference</h1>

<p><a href="https://arxiv.org/pdf/1409.0473.pdf">NEURAL MACHINE TRANSLATION BY JOINTLY LEARNING TO ALIGN AND TRANSLATE Dzmitry Bahdanau Jacobs University Bremen, Germany KyungHyun Cho Yoshua Bengioâˆ—</a></p>

<p><a href="https://www.deeplearningbook.org/">Deep Learning (deeplearningbook.org)</a></p>

<p><a href="https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646">Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems: GÃ©ron, AurÃ©lien: 9781492032649: Amazon.com: Books</a></p>

<p><a href="https://www.amazon.com/Learning-Deep-Processing-Transformers-TensorFlow/dp/0137470355">Learning Deep Learning: Theory and Practice of Neural Networks, Computer Vision, Natural Language Processing, and Transformers Using TensorFlow: Ekman, Magnus: 9780137470358: Amazon.com: Books</a></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#attention" class="page__taxonomy-item p-category" rel="tag">Attention</a><span class="sep">, </span>
    
      <a href="/tags/#deep-learning" class="page__taxonomy-item p-category" rel="tag">deep learning</a><span class="sep">, </span>
    
      <a href="/tags/#machine-learning" class="page__taxonomy-item p-category" rel="tag">Machine Learning</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dlarchitecture" class="page__taxonomy-item p-category" rel="tag">DLArchitecture</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-01-11T00:00:00+09:00">January 11, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=What+is+Attention%3FWhy+softmax+in+hidden+layer+output%3F%20http%3A%2F%2Flocalhost%3A4000%2Fdlarchitecture%2FWhy-Attention-use-sofmtax%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdlarchitecture%2FWhy-Attention-use-sofmtax%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdlarchitecture%2FWhy-Attention-use-sofmtax%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      


  

  

  
  	
  	
  	
  	
  	


  <nav class="pagination_prev_next">
    
      <a href="#" class="pagination_prev_next--pager disabled">ì²« ë²ˆì§¸ ê¸€ìž…ë‹ˆë‹¤</a>
    
    
      <a href="/dlarchitecture/Conv-intution/" class="pagination_prev_next--pager"><span class="prev_next">ë‹¤ìŒ ê¸€  &nbsp  </span>Convolution Neural Network : intuition</a>
    
  </nav>


<!-- 
  <nav class="pagination">
    
      <a href="/datastructure/TBT-morris/" class="pagination--pager" title="Threaded Binary tree and Morris Traversal
">Previous</a>
    
    
      <a href="/UNIX-Commandsmd/" class="pagination--pager" title="Unix Commandsmd
">Next</a>
    
  </nav>
 -->
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Numeric/" rel="permalink">Numeric
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
Numeric Typesë¼ëŠ” Built-in Objectsë¥¼ ìž˜ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ Built-in Objectsì— ì–´ë–¤ Literalsë“¤ì´ ìžˆê³  , ì–´ë–¤ operatorë“¤ì„ ì œê³µí•˜ëŠ”ì§€ ì•Œì•„ì•¼í•©ë‹ˆë‹¤. ì´ê²ƒë“¤ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤ .
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/standfordml/polynominal-regerssion/" rel="permalink">Polynomial Regression
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Standford ML
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/Built-in-Objects/" rel="permalink">What is Objects and Why use Built-in objects
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Python Objects
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/dls_c3/Setting-your-goal/" rel="permalink">Setting Your Goal
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">DeepLearning.ai Dls ML strategy (Metric, Data Split)
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Choi Woongjoon. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
<script src="/assets/js/main.min.js"></script>







    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'woongjoonchoi/Comments');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'photon-dark');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>
  



<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
extensions: ["tex2jax.js"],
jax: ["input/TeX", "output/HTML-CSS"],
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ],
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
processEscapes: true
},
"HTML-CSS": { availableFonts: ["TeX"] }
});
</script>

  </body>
</html>
